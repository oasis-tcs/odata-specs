<select id="darkmode">
  <option value="off">Light</option>
  <option value="on">Dark</option>
  <option value="auto">Auto</option>
</select>
<script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    function darkmode_auto() {
      if (darkmode_switch.value === "auto") {
        if (darkmode_query.matches) document.body.classList.add("darkmode");
        else document.body.classList.remove("darkmode");
      }
    }

    function darkmode_manual() {
      localStorage.setItem("odata-specs/darkmode", darkmode_switch.value);
      switch (darkmode_switch.value) {
        case "off":
          document.body.classList.remove("darkmode");
          break;
        case "on":
          document.body.classList.add("darkmode");
          break;
        case "auto":
          darkmode_auto();
          break;
      }
    }

    const darkmode_query = matchMedia("(prefers-color-scheme: dark)");
    darkmode_query.addEventListener("change", darkmode_auto);
    const darkmode_switch = document.getElementById("darkmode");
    darkmode_switch.value =
      localStorage.getItem("odata-specs/darkmode") || "off";
    darkmode_switch.addEventListener("change", darkmode_manual);
    darkmode_manual();
  });
</script>
