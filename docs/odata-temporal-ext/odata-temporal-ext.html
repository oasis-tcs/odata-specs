<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="description" content="This specification defines how to represent and interact with time-dependent data using the Open Data Protocol (OData)." />
  <title>OData Extension for Temporal Data Version 4.0</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="styles/markdown-styles-v1.7.3b.css" />
  <link rel="stylesheet" href="styles/odata.css" />
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<p><img src="https://docs.oasis-open.org/templates/OASISLogo-v3.0.png" alt="OASIS Logo" /></p>
<hr />
<h1 id="odata-extension-for-temporal-data-version-40">OData Extension for Temporal Data Version 4.0</h1>
<h2 id="committee-specification-draft-04">Committee Specification Draft 04</h2>
<h2 id="25-january-2022">25 January 2022</h2>
<p><span class="math inline">\(\hbox{}\)</span></p>
<h4 id="this-stage">This stage:</h4>
<p><a href="https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/csd04/odata-temporal-ext-v4.0-csd04.md">https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/csd04/odata-temporal-ext-v4.0-csd04.md</a> (Authoritative)<br />
<a href="https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/csd04/odata-temporal-ext-v4.0-csd04.html">https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/csd04/odata-temporal-ext-v4.0-csd04.html</a><br />
<a href="https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/csd04/odata-temporal-ext-v4.0-csd04.pdf">https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/csd04/odata-temporal-ext-v4.0-csd04.pdf</a></p>
<h4 id="previous-stage">Previous stage:</h4>
<p><a href="https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/cs01/odata-temporal-ext-v4.0-cs01.docx">https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/cs01/odata-temporal-ext-v4.0-cs01.docx</a> (Authoritative)<br />
<a href="https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/cs01/odata-temporal-ext-v4.0-cs01.html">https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/cs01/odata-temporal-ext-v4.0-cs01.html</a><br />
<a href="https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/cs01/odata-temporal-ext-v4.0-cs01.pdf">https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/cs01/odata-temporal-ext-v4.0-cs01.pdf</a></p>
<h4 id="latest-stage">Latest stage:</h4>
<p><a href="https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/odata-temporal-ext-v4.0.md">https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/odata-temporal-ext-v4.0.md</a> (Authoritative)<br />
<a href="https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/odata-temporal-ext-v4.0.html">https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/odata-temporal-ext-v4.0.html</a><br />
<a href="https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/odata-temporal-ext-v4.0.pdf">https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/odata-temporal-ext-v4.0.pdf</a></p>
<h4 id="technical-committee">Technical Committee:</h4>
<p><a href="https://www.oasis-open.org/committees/odata/">OASIS Open Data Protocol (OData) TC</a></p>
<h4 id="chairs">Chairs:</h4>
<p>Ralf Handl (<a href="mailto:ralf.handl@sap.com">ralf.handl@sap.com</a>), <a href="http://www.sap.com/">SAP SE</a><br />
Michael Pizzo (<a href="mailto:mikep@microsoft.com">mikep@microsoft.com</a>), <a href="http://www.microsoft.com/">Microsoft</a></p>
<h4 id="editors">Editors:</h4>
<p>Ralf Handl (<a href="mailto:ralf.handl@sap.com">ralf.handl@sap.com</a>), <a href="https://www.sap.com/">SAP SE</a><br />
Hubert Heijkers (<a href="mailto:hubert.heijkers@nl.ibm.com">hubert.heijkers@nl.ibm.com</a>), <a href="https://www.ibm.com/">IBM</a><br />
Gerald Krause (<a href="mailto:gerald.krause@sap.com">gerald.krause@sap.com</a>), <a href="https://www.sap.com/">SAP SE</a><br />
Michael Pizzo (<a href="mailto:mikep@microsoft.com">mikep@microsoft.com</a>), <a href="https://www.microsoft.com/">Microsoft</a><br />
Heiko Theißen (<a href="mailto:heiko.theissen@sap.com">heiko.theissen@sap.com</a>), <a href="https://www.sap.com/">SAP SE</a><br />
Martin Zurmuehl (<a href="mailto:martin.zurmuehl@sap.com">martin.zurmuehl@sap.com</a>), <a href="https://www.sap.com/">SAP SE</a></p>
<h4 id="additional-artifacts"><a name="AdditionalArtifacts">Additional artifacts:</a></h4>
<p>This document is one component of a Work Product that also includes:</p>
<ul>
<li>ABNF components: <em>OData Temporal ABNF Construction Rules Version 4.0 and OData Temporal ABNF Test Cases</em>: <a href="https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/csd04/abnf/">https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/csd04/abnf/</a></li>
<li>OData Temporal Vocabulary:
<ul>
<li><a href="https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/csd04/vocabularies/Org.OData.Temporal.V1.json">https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/csd04/vocabularies/Org.OData.Temporal.V1.json</a></li>
<li><a href="https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/csd04/vocabularies/Org.OData.Temporal.V1.xml">https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/csd04/vocabularies/Org.OData.Temporal.V1.xml</a></li>
</ul></li>
</ul>
<h4 id="related-work"><a name="RelatedWork">Related work:</a></h4>
<p>This specification is related to:</p>
<ul>
<li><em>OData Version 4.02</em>. Edited by Michael Pizzo, Ralf Handl, and Heiko Theißen. A multi-part Work Product that includes:
<ul>
<li><em>OData Version 4.02 Part 1: Protocol</em>. Latest stage. <a href="https://docs.oasis-open.org/odata/odata/v4.0/odata-v4.0-part1-protocol.html">https://docs.oasis-open.org/odata/odata/v4.0/odata-v4.0-part1-protocol.html</a></li>
<li><em>OData Version 4.02 Part 2: URL Conventions</em>. Latest stage. <a href="https://docs.oasis-open.org/odata/odata/v4.0/odata-v4.0-part2-url-conventions.html">https://docs.oasis-open.org/odata/odata/v4.0/odata-v4.0-part2-url-conventions.html</a></li>
<li><em>ABNF components: OData ABNF Construction Rules Version 4.02 and OData ABNF Test Cases</em>. <a href="https://docs.oasis-open.org/odata/odata/v4.0/csd04/abnf/">https://docs.oasis-open.org/odata/odata/v4.0/csd04/abnf/</a></li>
</ul></li>
<li><em>OData Vocabularies Version 4.0</em>. Edited by Michael Pizzo, Ralf Handl, and Ram Jeyaraman. Latest stage: <a href="https://docs.oasis-open.org/odata/odata-vocabularies/v4.0/odata-vocabularies-v4.0.html">https://docs.oasis-open.org/odata/odata-vocabularies/v4.0/odata-vocabularies-v4.0.html</a></li>
<li><em>OData Common Schema Definition Language (CSDL) JSON Representation Version 4.02</em>. Edited by Michael Pizzo, Ralf Handl, and Heiko Theißen. Latest stage: <a href="https://docs.oasis-open.org/odata/odata-csdl-json/v4.0/odata-csdl-json-v4.0.html">https://docs.oasis-open.org/odata/odata-csdl-json/v4.0/odata-csdl-json-v4.0.html</a></li>
<li><em>OData Common Schema Definition Language (CSDL) XML Representation Version 4.02</em>. Edited by Michael Pizzo, Ralf Handl, and Heiko Theißen. Latest stage: <a href="https://docs.oasis-open.org/odata/odata-csdl-xml/v4.0/odata-csdl-xml-v4.0.html">https://docs.oasis-open.org/odata/odata-csdl-xml/v4.0/odata-csdl-xml-v4.0.html</a></li>
<li><em>OData JSON Format Version 4.02</em>. Edited by Michael Pizzo, Ralf Handl, and Heiko Theißen. Latest stage: <a href="https://docs.oasis-open.org/odata/odata-json-format/v4.02/odata-json-format-v4.02.html">https://docs.oasis-open.org/odata/odata-json-format/v4.02/odata-json-format-v4.02.html</a></li>
<li><em>OData Data Aggregation Extension Version 4.0</em>. Edited by Ralf Handl, Hubert Heijkers, Gerald Krause, Michael Pizzo, Heiko Theißen, and Martin Zurmuehl. Latest stage: <a href="https://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/odata-data-aggregation-ext-v4.0.html">https://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/odata-data-aggregation-ext-v4.0.html</a></li>
</ul>
<h4 id="abstract">Abstract:</h4>
<p>This specification defines how to represent and interact with time-dependent data using the Open Data Protocol (OData).</p>
<h4 id="status">Status:</h4>
<p>This document was last revised or approved by the OASIS Open Data Protocol (OData) TC on the above date. The level of approval is also listed above. Check the "Latest stage" location noted above for possible later revisions of this document. Any other numbered Versions and other technical work produced by the Technical Committee (TC) are listed at <a href="https://www.oasis-open.org/committees/tc_home.php?wg_abbrev=odata#technical">https://www.oasis-open.org/committees/tc_home.php?wg_abbrev=odata#technical</a>.</p>
<p>TC members should send comments on this specification to the TC's email list. Others should send comments to the TC's public comment list, after subscribing to it by following the instructions at the "<a href="https://www.oasis-open.org/committees/comments/index.php?wg_abbrev=odata">Send A Comment</a>" button on the TC's web page at <a href="https://www.oasis-open.org/committees/odata/">https://www.oasis-open.org/committees/odata/</a>.</p>
<p>This specification is provided under the <a href="https://www.oasis-open.org/policies-guidelines/ipr/#RF-on-RAND-Mode">RF on RAND Terms Mode</a> of the <a href="https://www.oasis-open.org/policies-guidelines/ipr/">OASIS IPR Policy</a>, the mode chosen when the Technical Committee was established. For information on whether any patents have been disclosed that may be essential to implementing this specification, and any offers of patent licensing terms, please refer to the Intellectual Property Rights section of the TC's web page (<a href="https://www.oasis-open.org/committees/odata/ipr.php">https://www.oasis-open.org/committees/odata/ipr.php</a>).</p>
<p>Note that any machine-readable content (<a href="https://www.oasis-open.org/policies-guidelines/tc-process-2017-05-26/#wpComponentsCompLang">Computer Language Definitions</a>) declared Normative for this Work Product is provided in separate plain text files. In the event of a discrepancy between any such plain text file and display content in the Work Product's prose narrative document(s), the content in the separate plain text file prevails.</p>
<h4 id="key-words">Key words:</h4>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 <a href="#rfc2119">RFC2119</a> and <a href="#rfc8174">RFC8174</a> when, and only when, they appear in all capitals, as shown here.</p>
<h4 id="citation-format">Citation format:</h4>
<p>When referencing this specification the following citation format should be used:</p>
<p><strong>[OData-Temporal-v4.0]</strong></p>
<p><em>OData Extension for Temporal Data Version 4.0</em>. Edited by Ralf Handl, Hubert Heijkers, Gerald Krause, Michael Pizzo, Heiko Theißen, and Martin Zurmuehl. 25 January 2022. OASIS Committee Specification Draft 04. <a href="https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/csd04/odata-temporal-ext-v4.0-csd04.html">https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/csd04/odata-temporal-ext-v4.0-csd04.html</a>. Latest stage: <a href="https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/odata-temporal-ext-v4.0.html">https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/odata-temporal-ext-v4.0.html</a>.</p>
<h4 id="notices">Notices</h4>
<p>Copyright © OASIS Open 2022. All Rights Reserved.</p>
<p>Distributed under the terms of the OASIS <a href="https://www.oasis-open.org/policies-guidelines/ipr/">IPR Policy</a>.</p>
<p>The name "OASIS" is a trademark of <a href="https://www.oasis-open.org/">OASIS</a>, the owner and developer of this specification, and should be used only to refer to the organization and its official outputs.</p>
<p>For complete copyright information please see the full Notices section in an Appendix <a href="#Notices">below</a>.</p>
<hr />
<h1 id="table-of-contents">Table of Contents</h1>
<div class="toc">
<ul>
<li><a href="#Introduction">1 Introduction</a>
<ul>
<li><a href="#ChangesfromEarlierVersions">1.1 Changes from Earlier Versions</a></li>
<li><a href="#Glossary">1.2 Glossary</a>
<ul>
<li><a href="#DefinitionsofTerms">1.2.1 Definitions of Terms</a>
<ul>
<li><a href="#ApplicationTime">1.2.1.1 Application Time</a></li>
<li><a href="#SystemTime">1.2.1.2 System Time</a></li>
<li><a href="#TemporalObject">1.2.1.3 Temporal Object</a></li>
<li><a href="#TimeSlice">1.2.1.4 Time Slice</a>
<ul>
<li><a href="#ClosedOpenSemantics">1.2.1.4.1 Closed-Open Semantics</a></li>
<li><a href="#ClosedClosedSemantics">1.2.1.4.2 Closed-Closed Semantics</a></li>
</ul></li>
<li><a href="#SnapshotEntitySet">1.2.1.5 Snapshot Entity Set</a></li>
<li><a href="#TimelineEntitySet">1.2.1.6 Timeline Entity Set</a></li>
</ul></li>
<li><a href="#DocumentConventions">1.2.2 Document Conventions</a></li>
</ul></li>
</ul></li>
<li><a href="#Overview">2 Overview</a>
<ul>
<li><a href="#ExampleModel">2.1 Example Model</a></li>
<li><a href="#ExampleData">2.2 Example Data</a></li>
<li><a href="#ExampleUseCases">2.3 Example Use Cases</a></li>
</ul></li>
<li><a href="#VocabularyforTemporalData">3 Vocabulary for Temporal Data</a></li>
<li><a href="#TemporalRequests">4 Temporal Requests</a>
<ul>
<li><a href="#TemporalExpressions">4.1 Temporal Expressions</a></li>
<li><a href="#QueryingTemporalData">4.2 Querying Temporal Data</a>
<ul>
<li><a href="#PropagationofTemporalQueryOptions">4.2.1 Propagation of Temporal Query Options</a></li>
<li><a href="#QueryOptionat">4.2.2 Query Option <code>$at</code></a></li>
<li><a href="#QueryOptionsfromtoandtoInclusive">4.2.3 Query Options <code>$from</code>, <code>$to</code>, and <code>$toInclusive</code></a></li>
<li><a href="#InteractionwithStandardSystemQueryOptions">4.2.4 Interaction with Standard System Query Options</a></li>
<li><a href="#RequestingChangestoTemporalData">4.2.5 Requesting Changes to Temporal Data</a></li>
</ul></li>
<li><a href="#ModifyingTemporalData">4.3 Modifying Temporal Data</a>
<ul>
<li><a href="#DirectModificationofTimeSlices">4.3.1 Direct Modification of Time Slices</a></li>
<li><a href="#OperationsonTemporalObjects">4.3.2 Operations on Temporal Objects</a>
<ul>
<li><a href="#UpdateduringaPeriod">4.3.2.1 Update during a Period</a></li>
<li><a href="#UpsertduringaPeriod">4.3.2.2 Upsert during a Period</a></li>
<li><a href="#DeleteduringaPeriod">4.3.2.3 Delete during a Period</a></li>
</ul></li>
<li><a href="#ETags">4.3.3 ETags</a></li>
<li><a href="#ReadEditNavigationandAssociationURLs">4.3.4 Read, Edit, Navigation, and Association URLs</a></li>
</ul></li>
</ul></li>
<li><a href="#Conformance">5 Conformance</a></li>
<li><a href="#References">A References</a>
<ul>
<li><a href="#NormativeReferences">A.1 Normative References</a></li>
<li><a href="#InformativeReferences">A.2 Informative References</a></li>
</ul></li>
<li><a href="#Acknowledgments">B Acknowledgments</a>
<ul>
<li><a href="#SpecialThanks">B.1 Special Thanks</a></li>
<li><a href="#Participants">B.2 Participants</a></li>
</ul></li>
<li><a href="#RevisionHistory">C Revision History</a></li>
<li><a href="#Notices">D Notices</a></li>
</ul>
</div>
<hr />
<h1 id="1-introduction"><a name="Introduction" href="#Introduction">1 Introduction</a></h1>
<p>This specification adds the notion of time-dependency to the Open Data Protocol (OData) without changing any of the base principles of OData. It defines semantics and a representation for temporal data, especially:</p>
<ul>
<li>Semantics and operations for querying and modifying temporal data,</li>
<li>Vocabulary terms to annotate which data depends on time, and how.</li>
</ul>
<h2 id="11-changes-from-earlier-versions"><a name="ChangesfromEarlierVersions" href="#ChangesfromEarlierVersions">1.1 Changes from Earlier Versions</a></h2>
<!-- TODO -->

<!-- Describe significant changes from previous differently-numbered Versions, not changes between stages of the current Version -->

<h2 id="12-glossary"><a name="Glossary" href="#Glossary">1.2 Glossary</a></h2>
<h3 id="121-definitions-of-terms"><a name="DefinitionsofTerms" href="#DefinitionsofTerms">1.2.1 Definitions of Terms</a></h3>
<h4 id="1211-application-time"><a name="ApplicationTime" href="#ApplicationTime">1.2.1.1 Application Time</a></h4>
<p>Application time is used to describe data that is known to change over time, for example the budget of a department, or which department an employee works for. Application time may capture planned changes in the future, for example transferring an employee to a new department next month or capturing next year's budget for a department. Both future and past data can be changed.</p>
<h4 id="1212-system-time"><a name="SystemTime" href="#SystemTime">1.2.1.2 System Time</a></h4>
<p>System time is used to record when data became known by the "system of record". System time does not extend into the future, and record entries are only added and are never changed.</p>
<p>System time is never manipulated directly, and typically not visible in APIs, except for "last changed at" time stamps, and the corresponding properties are read-only.</p>
<p>As system time is typically not visible in APIs, we do not consider this in the remainder of this document.</p>
<h4 id="1213-temporal-object"><a name="TemporalObject" href="#TemporalObject">1.2.1.3 Temporal Object</a></h4>
<p>A temporal object is a set of data whose change over time is tracked by the service as a sequence of <a href="#TimeSlice">time slices</a>.</p>
<h4 id="1214-time-slice"><a name="TimeSlice" href="#TimeSlice">1.2.1.4 Time Slice</a></h4>
<p>A piece of temporal data with attached time period, documenting that the data did not change during this time period.</p>
<p>Time slices for the same <a href="#TemporalObject">temporal object</a> are non-overlapping, so for any given point in time there is at most one slice whose time period contains that point in time.</p>
<p>Time slices for a temporal object need not cover the complete timeline. There can be points in time for which no time slice exists, indicating that the object's values are not known to the service.</p>
<h5 id="12141-closed-open-semantics"><a name="ClosedOpenSemantics" href="#ClosedOpenSemantics">1.2.1.4.1 Closed-Open Semantics</a></h5>
<p>Time slices typically use closed-open semantics, following <strong><a href="#SQL">[SQL:2011]</a></strong>. This means the start is part of the period, the end is not part of the period, and for directly adjacent time slices the end of the earlier time slice is identical to the start of the next time slice. The period start must be less than the period end.</p>
<h5 id="12142-closed-closed-semantics"><a name="ClosedClosedSemantics" href="#ClosedClosedSemantics">1.2.1.4.2 Closed-Closed Semantics</a></h5>
<p>Some software systems predating the availability of temporal databases and with data type <em>date</em> for the application-time period start and end use closed-closed semantics. Temporal services on top of these systems can either convert their period end boundaries on-the-fly by adding one day on the way out and subtracting one day on the way in, or alternatively express the used time slice semantics via <a href="#VocabularyforTemporalData">annotations</a>.</p>
<h4 id="1215-snapshot-entity-set"><a name="SnapshotEntitySet" href="#SnapshotEntitySet">1.2.1.5 Snapshot Entity Set</a></h4>
<p>An entity in a snapshot entity set represents a <a href="#TemporalObject">temporal object</a> at a specified point in time. When the entity is addressed via a resource path (directly or via related resources), the point in time must be specified, see section "<a href="#PropagationofTemporalQueryOptions">Propagation of Temporal Query Options</a>" for details on how to determine this point in time.</p>
<p>The entity's id and its canonical URL are independent of this point in time. Hence, they are sufficient to <em>reference</em> the entity but not <em>address</em> it. In other words: the entity can be considered a function that maps each point in time to an instance of the entity type. That function can be <em>referenced</em> but only its values can be <em>addressed</em>.</p>
<p>Without a point in time, statements about individual structural or navigation properties of the entity or even about its existence cannot be made, and <a href="#RequestingChangestoTemporalData">change tracking</a> is not possible.</p>
<p>Snapshot entity sets MUST be <a href="#VocabularyforTemporalData">annotated</a> with a <code>Timeline</code> of type <code>TimelineSnapshot</code>.</p>
<h4 id="1216-timeline-entity-set"><a name="TimelineEntitySet" href="#TimelineEntitySet">1.2.1.6 Timeline Entity Set</a></h4>
<p>An entity in a timeline entity set represents one <a href="#TimeSlice">time slice</a> of a <a href="#TemporalObject">temporal object</a>, and all time slices of that temporal object are part of the entity set.</p>
<p>The entity's id and its canonical URL depend on the period of application time of the corresponding time slice. <em>Referencing</em> and <em>addressing</em> the entity are equivalent concepts, unlike in the snapshot case.</p>
<p>The response to a time-range request need not reflect the time-slice cut of the underlying data model.</p>
<p>Services MAY condense/defragment adjacent time slices that do not differ in represented properties other than the period boundaries. This reduces the payload size, and it also avoids potential information leakage if the service only publishes a projection of the underlying data model.</p>
<p>Services MAY also split time slices to align their boundaries with nested expanded time slices to represent a "coarsest common slicing" across an expand tree.</p>
<p>Timeline entity sets MUST be <a href="#VocabularyforTemporalData">annotated</a> with a <code>Timeline</code> of type <code>TimelineVisible</code>.</p>
<h3 id="122-document-conventions"><a name="DocumentConventions" href="#DocumentConventions">1.2.2 Document Conventions</a></h3>
<p>Keywords defined by this specification use <code>this  monospaced  font</code>.</p>
<p>Some sections of this specification are illustrated with non-normative examples.</p>
<div class="example">
<p>Example 1: text describing an example uses this paragraph style</p>
<pre><code>Non-normative examples use this paragraph style.</code></pre>
</div>
<p>All examples in this document are non-normative and informative only.</p>
<p>All other text is normative unless otherwise labeled.</p>
<div class="example">
<p>Here is a customized command line which will generate HTML from this markdown file (named <code>odata-temporal-ext-v4.0-csd04.md</code>). Line breaks are added for readability only:</p>
<pre><code>pandoc -f gfm+tex_math_dollars+fenced_divs
       -t html
       -o odata-temporal-ext-v4.0-csd04.html
       -c styles/markdown-styles-v1.7.3b.css
       -c styles/odata.css
       -s
       --mathjax
       --eol=lf
       --wrap=none
       --metadata pagetitle=&quot;OData Extension for Temporal Data Version 4.0&quot;
       odata-temporal-ext-v4.0-csd04.md</code></pre>
<p>This uses pandoc 3.1.2 from <a href="https://github.com/jgm/pandoc/releases/tag/3.1.2">https://github.com/jgm/pandoc/releases/tag/3.1.2</a>.</p>
</div>
<hr />
<h1 id="2-overview"><a name="Overview" href="#Overview">2 Overview</a></h1>
<p>When keeping track of time, the most important questions are:</p>
<ul>
<li>When did or will something happen?</li>
<li>When did we learn that it happened?</li>
</ul>
<p>This leads to two "directions" or "dimensions" of time (measured as a date or date-plus-time value):</p>
<ul>
<li><a href="#ApplicationTime">Application time</a>, also called actual time, business time, effective time, or valid time, and</li>
<li><a href="#SystemTime">System time</a>, also called recording time, audit time, or transaction time.</li>
</ul>
<p>Keeping track of time is typically done by storing data together with the time period for which that data is deemed valid or effective, using separate periods for application time and system time, and the time periods are part of the logical key for "records". See <strong><a href="#SQL">[SQL:2011]</a></strong> or <strong><a href="#Kulkarni">[Kulkarni]</a></strong> on how this is done in the SQL standard.</p>
<p>A consumer's perspective on this data can be different: even if time is tracked internally, the period of time may or may not be visible in a consumer's perspective, and even if visible the related properties are often not considered part of an entity's identity. For example, an employee is still the same person even after switching to another department.</p>
<p>The goals of this extension are:</p>
<ul>
<li>Keep the API models as simple as possible by allowing to hide time-dependency,</li>
<li>Provide easy means for <a href="#QueryOptionat">point-in-time queries</a> even if time-dependency is hidden,</li>
<li>Provide easy means for <a href="#QueryOptionsfromtoandtoInclusive">time-range queries</a> if time-dependency is visible, and</li>
<li>Provide easy means for modifying time-dependent data.</li>
</ul>
<h2 id="21-example-model"><a name="ExampleModel" href="#ExampleModel">2.1 Example Model</a></h2>
<p>Assume a simple scenario: employees will work in different roles and in different departments during their career, and sometimes they even change their name. At each point in time the employee has exactly one name, one job title, and is assigned to one department.</p>
<p>Employees are assigned an immutable ID when first entering the company, and all employee-related data will be recorded with an application-time period attached. This allows entering planned changes ahead of time, using a future application-time start date: if an employee will get a different job title or switch to a different department, this data can already be entered into the system and stored as a new record.</p>
<p>In the sections below we will discuss two different API models that can be backed by the same storage model:</p>
<div class="example">
<p>Example <a name="api1" href="#api1">2</a>: model for <code>api-1</code> with snapshot entity sets (hidden application time), key properties marked with {id}</p>
</div>
<p><strong>TODO: SVG image</strong></p>
<p><img src="https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/cs01/odata-temporal-ext-v4.0-cs01_files/image002.png" /></p>
<p>and</p>
<div class="example">
<p>Example <a name="api2" href="#api2">3</a>: model for <code>api-2</code> with timeline entity sets (visible application time), key properties marked with {id}</p>
</div>
<p><strong>TODO: SVG image</strong></p>
<p><img src="https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/cs01/odata-temporal-ext-v4.0-cs01_files/image003.png" /></p>
<h2 id="22-example-data"><a name="ExampleData" href="#ExampleData">2.2 Example Data</a></h2>
<p>Both API models in the previous section are views on the same underlying data. A possible storage model for this data is:</p>
<div class="example">
<p>Example 4: simple storage model: object keys in dark green, temporal sub-keys in light green, foreign keys in orange, non-key fields in blue</p>
</div>
<p><strong>TODO: SVG image</strong></p>
<p><img src="https://docs.oasis-open.org/odata/odata-temporal-ext/v4.0/cs01/odata-temporal-ext-v4.0-cs01_files/image004.png" /></p>
<p>The period start date is used as the temporal sub-key for identifying time slices together with the key of the temporal object.</p>
<p>Note: alternatively, the period end date could have been used as temporal sub-key, or the primary key of the time slice tables could have been an artificial key (sequence number, UUID, ...) with both the temporal object key and the period boundaries as non-key fields.</p>
<p>The following example data will be used to further illustrate the capabilities introduced by this extension. It assumes that the example services only support four-digit years.</p>
<div class="example">
<p>Example 5: example data: object key in dark green, temporal sub-key in light green, foreign keys in orange, non-key fields in blue</p>
<div class="example-data" style="width:600px;height:440px">
<svg viewBox="0 0 600 700">
  <defs>
    <marker id="begin" viewBox="0 0 10 10" refX="0" refY="5" orient="auto" markerWidth="5" markerHeight="5">
      <path d="M10,0 L0,5 L10,10 z" />
    </marker>
    <marker id="end" viewBox="0 0 10 10" refX="10" refY="5" orient="auto" markerWidth="5" markerHeight="5">
      <path d="M0,0 L10,5 L0,10 z" />
    </marker>
  </defs>
  <path d="M20,190 l0,40 l320,0 l0,40" marker-start="url(#begin)" marker-end="url(#end)" />
</svg>

<div class="temp-2">
<p><strong>Departments</strong></p>
<table>
<thead>
<tr class="header">
<th>ID</th>
<th>From</th>
<th>To</th>
<th>Name</th>
<th>Budget</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>D08</td>
<td>2010-01-01</td>
<td>2012-01-01</td>
<td>Support</td>
<td>1000</td>
</tr>
<tr class="even">
<td>D08</td>
<td>2012-01-01</td>
<td>2012-06-01</td>
<td>Support</td>
<td>1250</td>
</tr>
<tr class="odd">
<td>D08</td>
<td>2012-06-01</td>
<td>2014-01-01</td>
<td>1st Level Support</td>
<td>1250</td>
</tr>
<tr class="even">
<td>D08</td>
<td>2014-01-01</td>
<td>max</td>
<td>1st Level Support</td>
<td>1400</td>
</tr>
<tr class="odd">
<td>D15</td>
<td>2010-01-01</td>
<td>2011-01-01</td>
<td>Services</td>
<td>1100</td>
</tr>
<tr class="even">
<td>D15</td>
<td>2011-01-01</td>
<td>max</td>
<td>Services</td>
<td>1170</td>
</tr>
</tbody>
</table>
</div>
<div class="temp-2 nav-6" style="top:240px">
<p><strong>Employees</strong></p>
<table>
<thead>
<tr class="header">
<th>ID</th>
<th>From</th>
<th>To</th>
<th>Name</th>
<th>Jobtitle</th>
<th>Department.ID</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>E314</td>
<td>2011-01-01</td>
<td>2013-10-01</td>
<td>McDevitt</td>
<td>Junior</td>
<td>D08</td>
</tr>
<tr class="even">
<td>E314</td>
<td>2013-10-01</td>
<td>2014-01-01</td>
<td>McDevitt</td>
<td>Senior</td>
<td>D08</td>
</tr>
<tr class="odd">
<td>E314</td>
<td>2014-01-01</td>
<td>max</td>
<td>McDevitt</td>
<td>Senior</td>
<td>D15</td>
</tr>
<tr class="even">
<td>E401</td>
<td>2009-11-01</td>
<td>2012-03-01</td>
<td>Norman</td>
<td>Expert</td>
<td>D15</td>
</tr>
<tr class="odd">
<td>E401</td>
<td>2012-03-01</td>
<td>max</td>
<td>Gibson</td>
<td>Expert</td>
<td>D15</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<h2 id="23-example-use-cases"><a name="ExampleUseCases" href="#ExampleUseCases">2.3 Example Use Cases</a></h2>
<p>A client might wish to query the example APIs in several ways:</p>
<ul>
<li>Snapshot API
<ol type="1">
<li>Retrieve a current employee, together with the employee's current department.</li>
<li>Retrieve an employee as of a particular point in time, including the employee's department as of that same point in time.</li>
</ol></li>
<li>Timeline API
<ol type="1">
<li>Retrieve employees that worked for the "Services" department in 2010.</li>
<li>Retrieve all time slices of an employee.</li>
<li>Retrieve all time slices of an employee for a given application-time period, including all time slices of the related departments within the application-time period of each employee time slice.</li>
<li>Change a department's budget in the past, present, or future.</li>
<li>Change an employee's association to a department in the past, present, or future.</li>
</ol></li>
</ul>
<hr />
<h1 id="3-vocabulary-for-temporal-data"><a name="VocabularyforTemporalData" href="#VocabularyforTemporalData">3 Vocabulary for Temporal Data</a></h1>
<p>The vocabulary for temporal data <a href="#ODataVocTemporal">OData-VocTemporal</a> defines a structured term for describing temporal query and modification capabilities of temporal services.</p>
<p>The term <code>ApplicationTimeSupport</code> describes the temporal capabilities of an entity set. It can be applied to an entity set, or to a containment navigation property to describe its implicit entity sets. It has a structured type with the following properties:</p>
<ul>
<li><code>UnitOfTime</code> describes the data type of the application-time period start and end values. Its value is a record of either type <code>UnitOfTimeDate</code> or <code>UnitOfTimeDateTimeOffset</code>.
<ul>
<li>Records of type <code>UnitOfTimeDateTimeOffset</code> MUST specify the property <code>Precision</code>.</li>
<li>Records of type <code>UnitOfTimeDate</code> MAY specify the property <code>ClosedClosedPeriods</code>.</li>
</ul></li>
<li><code>Timeline</code> describes the kind of temporal entity set. Its value is a record of either type <code>TimelineSnapshot</code> or <code>TimelineVisible</code>.
<ul>
<li><p>Records of type <code>TimelineSnapshot</code> MUST NOT specify any properties.</p></li>
<li><p>Records of type <code>TimelineVisible</code> MUST specify the properties <code>PeriodStart</code> and <code>PeriodEnd</code>.</p>
<ul>
<li>These properties MUST point to properties of the annotated entity set whose values are the period start and end of a time slice.</li>
<li>The start is always included in the time slice, the end is included if and only if the sibling property <code>UnitOfTime</code> is of type <code>UnitOfTimeDate</code> and specifies property <code>ClosedClosedPeriods</code> as <code>true</code>.</li>
<li>If the period end property does not specify a default value, a default value of "ad infinitum" is assumed.</li>
</ul>
<p>Records of type <code>TimelineVisible</code> MAY specify the property <code>ObjectKey</code>.</p>
<ul>
<li><code>ObjectKey</code> is the “sub-key” or “alternate key” that identifies time slices for a single temporal object. It is only necessary if the annotated entity set can contain time slices for more than one temporal object. <code>The object key is </code>a collection of property paths whose value combination uniquely identifies a temporal object.</li>
</ul></li>
</ul></li>
<li><code>SupportedActions</code> is a collection of qualified names of temporal actions that may be bound to the annotated entity set. These can be the <a href="#ModifyingTemporalData">standard actions defined in this specification</a>, or service-specific actions.</li>
</ul>
<div class="example">
<p>Example 6: <code>Employees</code> entity set from <a href="#api1">example model api-1</a> annotated with temporal terms</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="er">&quot;Employees&quot;:</span> <span class="fu">{</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;$Collection&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;$Type&quot;</span><span class="fu">:</span> <span class="st">&quot;OrgModel.Employee&quot;</span><span class="fu">,</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;@Temporal.ApplicationTimeSupport&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="dt">&quot;Timeline&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;@odata.type&quot;</span><span class="fu">:</span> <span class="st">&quot;https://oasis-tcs.github.io/odata-vocabularies/vocabularies/Org.OData.Temporal.V1.json#Temporal.TimelineSnapshot&quot;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">},</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="dt">&quot;UnitOfTime&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;@odata.type&quot;</span><span class="fu">:</span> <span class="st">&quot;https://oasis-tcs.github.io/odata-vocabularies/vocabularies/Org.OData.Temporal.V1.json#Temporal.UnitOfTimeDate&quot;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">}</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="fu">}</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span><span class="er">,</span></span></code></pre></div>
</div>
<div class="example">
<p>Example 7: <code>history</code> navigation property in entity set <code>Employees</code> from <a href="#api2">example model api-2</a> annotated with temporal terms</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="er">&quot;$Annotations&quot;:</span> <span class="fu">{</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;OrgModel.Default/Employees/history&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="dt">&quot;@Temporal.ApplicationTimeSupport&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;Timeline&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;@odata.type&quot;</span><span class="fu">:</span> <span class="st">&quot;https://oasis-tcs.github.io/odata-vocabularies/vocabularies/Org.OData.Temporal.V1.json#Temporal.TimelineVisible&quot;</span><span class="fu">,</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;TimeSliceStart&quot;</span><span class="fu">:</span> <span class="st">&quot;From&quot;</span><span class="fu">,</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;TimeSliceEnd&quot;</span><span class="fu">:</span> <span class="st">&quot;To&quot;</span><span class="fu">,</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;SupportedActions&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="st">&quot;Temporal.Update&quot;</span><span class="ot">,</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="st">&quot;Temporal.Upsert&quot;</span><span class="ot">,</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="st">&quot;Temporal.Delete&quot;</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="ot">]</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="fu">},</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;UnitOfTime&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">      </span><span class="dt">&quot;@odata.type&quot;</span><span class="fu">:</span> <span class="st">&quot;https://oasis-tcs.github.io/odata-vocabularies/vocabularies/Org.OData.Temporal.V1.json#Temporal.UnitOfTimeDate&quot;</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="fu">}</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">}</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="fu">}</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
</div>
<div class="example">
<p>Example <a name="CostCenters" href="#CostCenters">8</a>: <code>CostCenters</code> entity set containing time slices for multiple temporal objects, the temporal objects identified by combination of <code>AreaID</code> and <code>CostCenterID</code></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="er">&quot;CostCenter&quot;:</span> <span class="fu">{</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;$Kind&quot;</span><span class="fu">:</span> <span class="st">&quot;EntityType&quot;</span><span class="fu">,</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;$Key&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;tsid&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;tsid&quot;</span><span class="fu">:</span> <span class="fu">{},</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;AreaID&quot;</span><span class="fu">:</span> <span class="fu">{},</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;CostCenterID&quot;</span><span class="fu">:</span> <span class="fu">{},</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;ValidTo&quot;</span><span class="fu">:</span> <span class="fu">{</span> <span class="dt">&quot;$Type&quot;</span><span class="fu">:</span> <span class="st">&quot;Edm.Date&quot;</span> <span class="fu">},</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;ValidFrom&quot;</span><span class="fu">:</span> <span class="fu">{</span> <span class="dt">&quot;$Type&quot;</span><span class="fu">:</span> <span class="st">&quot;Edm.Date&quot;</span> <span class="fu">},</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;ProfitCenterID&quot;</span><span class="fu">:</span> <span class="fu">{</span> <span class="dt">&quot;$Nullable&quot;</span><span class="fu">:</span> <span class="kw">true</span> <span class="fu">},</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;DepartmentID&quot;</span><span class="fu">:</span> <span class="fu">{</span> <span class="dt">&quot;$Nullable&quot;</span><span class="fu">:</span> <span class="kw">true</span> <span class="fu">}</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span><span class="er">,</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="er">&quot;Default&quot;:</span> <span class="fu">{</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;$Kind&quot;</span><span class="fu">:</span> <span class="st">&quot;EntityContainer&quot;</span><span class="fu">,</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;CostCenters&quot;</span><span class="fu">:</span> <span class="fu">{</span> <span class="dt">&quot;$Collection&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span> <span class="dt">&quot;$Type&quot;</span><span class="fu">:</span> <span class="st">&quot;this.CostCenter&quot;</span> <span class="fu">}</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span><span class="er">,</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="er">&quot;$Annotations&quot;:</span> <span class="fu">{</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;this.Default/CostCenters&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="dt">&quot;@Temporal.ApplicationTimeSupport&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;UnitOfTime&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;@odata.type&quot;</span><span class="fu">:</span> <span class="st">&quot;https://oasis-tcs.github.io/odata-vocabularies/vocabularies/Org.OData.Temporal.V1.xml#Temporal.UnitOfTimeDate&quot;</span><span class="fu">,</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;ClosedClosedPeriods&quot;</span><span class="fu">:</span> <span class="kw">true</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="fu">},</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;Timeline&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;@odata.type&quot;</span><span class="fu">:</span> <span class="st">&quot;https://oasis-tcs.github.io/odata-vocabularies/vocabularies/Org.OData.Temporal.V1.xml#Temporal.TimelineVisible&quot;</span><span class="fu">,</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;PeriodStart&quot;</span><span class="fu">:</span> <span class="st">&quot;ValidFrom&quot;</span><span class="fu">,</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;PeriodEnd&quot;</span><span class="fu">:</span> <span class="st">&quot;ValidTo&quot;</span><span class="fu">,</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;ObjectKey&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;AreaID&quot;</span><span class="ot">,</span> <span class="st">&quot;CostCenterID&quot;</span><span class="ot">]</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="fu">},</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;SupportedActions&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="st">&quot;Temporal.Update&quot;</span><span class="ot">,</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="st">&quot;Temporal.Upsert&quot;</span><span class="ot">,</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="st">&quot;Temporal.Delete&quot;</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="ot">]</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">}</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="fu">}</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
</div>
<hr />
<h1 id="4-temporal-requests"><a name="TemporalRequests" href="#TemporalRequests">4 Temporal Requests</a></h1>
<h2 id="41-temporal-expressions"><a name="TemporalExpressions" href="#TemporalExpressions">4.1 Temporal Expressions</a></h2>
<p>A temporal expression is</p>
<ul>
<li>A date in the form <code>dateValue</code>, see <a href="#ODataABNF">OData-ABNF</a></li>
<li>A timestamp in the form <code>dateTimeOffsetValueInUrl</code>, see <a href="#ODataABNF">OData-ABNF</a></li>
<li>One of the literals <code>min</code> or <code>max</code></li>
<li>An expression resulting in a date or timestamp value</li>
</ul>
<p>The literals <code>min</code> and <code>max</code> are interpreted depending on the data type of the time period start and end. They represent the minimum and maximum values of the time period that the service will allow. Their values are service specific as they can depend on the capabilities of the underlying data model.</p>
<p>Note that there is no literal for "today" as clients and services can be in different time zones and thus can have different notions of which date is "today". Clients are advised to use concrete temporal values and should avoid using the URL function <code>now()</code> with period start and end of type <code>Edm.Date</code>.</p>
<p>Note that services may allow service-defined functions for temporal expressions, for example to deal with fiscal years in a particular company.</p>
<h2 id="42-querying-temporal-data"><a name="QueryingTemporalData" href="#QueryingTemporalData">4.2 Querying Temporal Data</a></h2>
<p>Temporal query options allow point-in-time as well as time-range queries. They take a temporal expression as their argument whose result type MUST match the type of the corresponding time period start and end.</p>
<p>Adding temporal query options to a request does not alter the response shape, it only affects the returned data.</p>
<p>Temporal query options can be used with data modification operations, in which case they do not alter the modification semantics of the request, they only affect the response. That is, they only influence the "implicit <code>GET</code>" after successful data modification.</p>
<p>If no temporal query options are specified,</p>
<ul>
<li>timeline entity sets return all time slices, and</li>
<li>snapshot entity sets return the snapshot valid at the time of the request.</li>
</ul>
<h3 id="421-propagation-of-temporal-query-options"><a name="PropagationofTemporalQueryOptions" href="#PropagationofTemporalQueryOptions">4.2.1 Propagation of Temporal Query Options</a></h3>
<p>Temporal query options can be specified for the requested resource, and for expanded navigation properties. They are propagated along navigation paths and <code>$expand</code> until overridden on an expanded navigation property, and the overridden query option values are propagated from there to further expanded navigation properties.</p>
<p>If any temporal query option is specified for an expanded navigation property, all temporal query options are overridden, and only the explicitly specified temporal query options take effect and are propagated further.</p>
<p>Temporal query options can be specified even if the directly addressed resource does not track time. In this case the temporal query options do not have any effect other than being propagated along <code>$expand</code>.</p>
<p>For entities in a <a href="#SnapshotEntitySet">snapshot entity set</a> the point in time for representing data is determined by the first applicable rule:</p>
<ol type="1">
<li>by the query option <a href="#QueryOptionat"><code>$at</code></a> nested within <code>$expand</code></li>
<li>by a <a href="#QueryOptionat"><code>$at</code></a> value propagated along <code>$expand</code></li>
<li>by <a href="#QueryOptionat"><code>$at</code></a> in the query option part of the request URL, which applies to every segment of the resource path and paths that occur in system query options</li>
<li>by the default value "now" - the logic for determining this value is service-specific</li>
</ol>
<p>For entities in a <a href="#TimelineEntitySet">timeline entity set</a> the time interval for filtering time slices is determined by the first applicable rule:</p>
<ol type="1">
<li>by nested temporal query options within <code>$expand</code></li>
<li>by temporal query option values propagated along <code>$expand</code></li>
<li>by temporal query options in the query option part of the request URL</li>
</ol>
<h3 id="422-query-option-at"><a name="QueryOptionat" href="#QueryOptionat">4.2.2 Query Option <code>$at</code></a></h3>
<p>The <code>$at</code> query option takes a temporal expression as its argument. It retrieves the snapshot whose application time period contains the value of <code>$at</code>.</p>
<p>For timeline entity sets and collection-valued navigation to timeline entity sets, <code>$at=&lt;point-in-time&gt;</code> is shorthand for</p>
<!-- TODO: css for block-quote -->

<blockquote>
<p><a href="#QueryOptionsfromtoandtoInclusive"><code>$from</code></a>=<code>&lt;point-in-time&gt;&amp;</code><a href="#QueryOptionsfromtoandtoInclusive"><code>$toInclusive</code></a><code>=&lt;point-in-time&gt;</code></p>
</blockquote>
<p>The query option <code>$at</code> can be combined with <code>$filter</code> and <code>$search</code>. Only entities satisfying all specified criteria are returned.</p>
<div class="example">
<p>Example 9: Retrieve current data of an employee</p>
<pre><code>GET /api-1/Employees(&#39;E314&#39;)</code></pre>
<p>results in</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;@odata.context&quot;</span><span class="fu">:</span> <span class="st">&quot;$metadata#Employees/$entity&quot;</span><span class="fu">,</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;ID&quot;</span><span class="fu">:</span> <span class="st">&quot;E314&quot;</span><span class="fu">,</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;McDevitt&quot;</span><span class="fu">,</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;Jobtitle&quot;</span><span class="fu">:</span> <span class="st">&quot;Senior&quot;</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
</div>
<div class="example">
<p>Example 10: retrieve employee at a specific point in application time</p>
<pre><code>GET /api-1/Employees(&#39;E314&#39;)?$at=2012-01-01</code></pre>
<p>results in</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;@odata.context&quot;</span><span class="fu">:</span> <span class="st">&quot;$metadata#Employees/$entity&quot;</span><span class="fu">,</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;ID&quot;</span><span class="fu">:</span> <span class="st">&quot;E314&quot;</span><span class="fu">,</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;McDevitt&quot;</span><span class="fu">,</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;Jobtitle&quot;</span><span class="fu">:</span> <span class="st">&quot;Junior&quot;</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
</div>
<div class="example">
<p>Example 11: retrieve multiple employees at a past point in time</p>
<pre><code>GET /api-1/Employees?$filter=contains(Name,&#39;i&#39;)&amp;$at=2012-01-01</code></pre>
<p>results in one time slice for each employee matching the filter at the specified point in time - note that E401 back then does not satisfy this condition</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;@odata.context&quot;</span><span class="fu">:</span> <span class="st">&quot;$metadata#Employees&quot;</span><span class="fu">,</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;value&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">{</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;ID&quot;</span><span class="fu">:</span> <span class="st">&quot;E314&quot;</span><span class="fu">,</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;McDevitt&quot;</span><span class="fu">,</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;Jobtitle&quot;</span><span class="fu">:</span> <span class="st">&quot;Junior&quot;</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">}</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="ot">]</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
</div>
<p>Expanding related entities in combination with <code>$at</code> is straight-forward: the response consists of the time slices of related entities that are valid at the requested point in time. The period boundaries of the nested entities reflect the actual validity of the related entities and are independent of the period boundaries of the base entity.</p>
<div class="example">
<p>Example 12: retrieve employee in the past, show the past department as of a later point in time</p>
<pre><code>GET
/api-1/Employees(&#39;E314&#39;)?$at=2012-01-01&amp;$expand=Department($at=2021-11-23)</code></pre>
<p>results in</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;@odata.context&quot;</span><span class="fu">:</span> <span class="st">&quot;$metadata#Employees/$entity&quot;</span><span class="fu">,</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;ID&quot;</span><span class="fu">:</span> <span class="st">&quot;E314&quot;</span><span class="fu">,</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;McDevitt&quot;</span><span class="fu">,</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;Jobtitle&quot;</span><span class="fu">:</span> <span class="st">&quot;Junior&quot;</span><span class="fu">,</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;Department&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="dt">&quot;ID&quot;</span><span class="fu">:</span> <span class="st">&quot;D08&quot;</span><span class="fu">,</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;1st Level Support&quot;</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="fu">}</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
</div>
<div class="example">
<p>Example 13: retrieve department in the future with expanded employees at the same point in time</p>
<pre><code>GET /api-1/Departments(&#39;D15&#39;)?$at=2015-01-01&amp;$expand=Employees</code></pre>
<p>results in</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;@odata.context&quot;</span><span class="fu">:</span> <span class="st">&quot;$metadata#Departments/$entity&quot;</span><span class="fu">,</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;ID&quot;</span><span class="fu">:</span> <span class="st">&quot;D15&quot;</span><span class="fu">,</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;Services&quot;</span><span class="fu">,</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;Employees&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">{</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;ID&quot;</span><span class="fu">:</span> <span class="st">&quot;E314&quot;</span><span class="fu">,</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;McDevitt&quot;</span><span class="fu">,</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;Jobtitle&quot;</span><span class="fu">:</span> <span class="st">&quot;Senior&quot;</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">{</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;ID&quot;</span><span class="fu">:</span> <span class="st">&quot;E401&quot;</span><span class="fu">,</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;Gibson&quot;</span><span class="fu">,</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;Jobtitle&quot;</span><span class="fu">:</span> <span class="st">&quot;Expert&quot;</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">}</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="ot">]</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
</div>
<h3 id="423-query-options-from-to-and-toinclusive"><a name="QueryOptionsfromtoandtoInclusive" href="#QueryOptionsfromtoandtoInclusive">4.2.3 Query Options <code>$from</code>, <code>$to</code>, and <code>$toInclusive</code></a></h3>
<p>The query options <code>$from</code>, <code>$to</code>, and <code>$toInclusive</code> only have an effect on timeline entity sets and collection-valued navigation to timeline entity sets. They each take a temporal expression as their argument.</p>
<p>Allowed combinations are:</p>
<ul>
<li><code>$from</code> and <code>$to</code> defines a closed-open interval</li>
<li><code>$from</code> and <code>$toInclusive</code> defines a closed-closed interval</li>
<li><code>$from</code> and neither <code>$to</code> nor <code>$toInclusive</code> defines a closed-closed interval with right boundary <code>max</code>.</li>
</ul>
<p>It is not allowed to combine <code>$from</code> and <code>$to</code>/<code>$toInclusive</code> with <a href="#QueryOptionat"><code>$at</code></a> because <code>$at=&lt;point-in-time&gt;</code> is shorthand for</p>
<blockquote>
<p><code>$from=&lt;point-in-time&gt;&amp;$toInclusive=&lt;point-in-time&gt;</code></p>
</blockquote>
<p>The result is restricted to time slices whose application-time period overlaps with the interval defined by the query option values, taking the closed-open or closed-closed semantics of the entity set's time slices into account. The benefit of the query options is that the client does not have to inspect the temporal annotations to determine the property names of the period boundaries, the period semantics, and get all comparison operators right.</p>
<p>For timeline entity sets with closed-open semantics <code>$from=&lt;start&gt;&amp;$to=&lt;end&gt;</code> is shorthand for</p>
<blockquote>
<p><code>$filter=&lt;time-slice-start&gt; lt &lt;end&gt; and &lt;time-slice-end&gt; gt &lt;start&gt;</code></p>
</blockquote>
<p>and for timeline entity sets with closed-closed semantics shorthand for</p>
<blockquote>
<p><code>$filter=&lt;time-slice-start&gt; lt &lt;end&gt; and &lt;time-slice-end&gt; ge &lt;start&gt;</code></p>
</blockquote>
<p>For timeline entity sets with closed-open semantics <code>$from=&lt;start&gt;&amp;$toInclusive=&lt;end&gt;</code> is shorthand for</p>
<blockquote>
<p><code>$filter=&lt;time-slice-start&gt; le &lt;end&gt; and &lt;time-slice-end&gt; gt &lt;start&gt;</code></p>
</blockquote>
<p>and for timeline entity sets with closed-closed semantics shorthand for</p>
<blockquote>
<p><code>$filter=&lt;time-slice-start&gt; le &lt;end&gt; and &lt;time-slice-end&gt; ge &lt;start&gt;</code></p>
</blockquote>
<p>The query options <code>$from</code> and <code>$to</code>/<code>$toInclusive</code> can be combined with <code>$filter</code> and <code>$search</code>. Only entities satisfying all specified criteria are returned.</p>
<p>If no <code>$select</code> is specified, each returned entity SHOULD contain the application-time period boundaries as part of the default selection.</p>
<div class="example">
<p>Example <a name="employeeHistory" href="#employeeHistory">14</a>: retrieve employee history over a period of application time</p>
<pre><code>GET /api-2/Employees?$expand=history($select=Name,Jobtitle)
                    &amp;$from=2012-03-01&amp;$to=2025-01-01</code></pre>
<p>results in one entity for each employee with time slices that overlap the specified application-time period:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;@odata.context&quot;</span><span class="fu">:</span> <span class="st">&quot;$metadata#Employees&quot;</span><span class="fu">,</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;value&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">{</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="er">    </span> <span class="er"> </span><span class="dt">&quot;ID&quot;</span><span class="fu">:</span> <span class="st">&quot;E314&quot;</span><span class="fu">,</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;history&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="fu">{</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;McDevitt&quot;</span><span class="fu">,</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;Jobtitle&quot;</span><span class="fu">:</span> <span class="st">&quot;Junior&quot;</span><span class="fu">,</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;From&quot;</span><span class="fu">:</span> <span class="st">&quot;2011-01-01&quot;</span><span class="fu">,</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;To&quot;</span><span class="fu">:</span> <span class="st">&quot;2013-10-01&quot;</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="fu">{</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;McDevitt&quot;</span><span class="fu">,</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;Jobtitle&quot;</span><span class="fu">:</span> <span class="st">&quot;Senior&quot;</span><span class="fu">,</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;From&quot;</span><span class="fu">:</span> <span class="st">&quot;2013-10-01&quot;</span><span class="fu">,</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;To&quot;</span><span class="fu">:</span> <span class="st">&quot;2014-01-01&quot;</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="fu">{</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="er">  </span><span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;McDevitt&quot;</span><span class="fu">,</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="er">        </span> <span class="er"> </span><span class="dt">&quot;Jobtitle&quot;</span><span class="fu">:</span> <span class="st">&quot;Senior&quot;</span><span class="fu">,</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;From&quot;</span><span class="fu">:</span> <span class="st">&quot;2014-01-01&quot;</span><span class="fu">,</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;To&quot;</span><span class="fu">:</span> <span class="st">&quot;9999-12-31&quot;</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="fu">}</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="ot">]</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">{</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;ID&quot;</span><span class="fu">:</span> <span class="st">&quot;E401&quot;</span><span class="fu">,</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;history&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="fu">{</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a><span class="er">    </span> <span class="er">     </span><span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;Gibson&quot;</span><span class="fu">,</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;Jobtitle&quot;</span><span class="fu">:</span> <span class="st">&quot;Expert&quot;</span><span class="fu">,</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">        </span><span class="dt">&quot;From&quot;</span><span class="fu">:</span> <span class="st">&quot;2012-03-01&quot;</span><span class="fu">,</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a><span class="er">        </span> <span class="er"> </span><span class="dt">&quot;To&quot;</span><span class="fu">:</span> <span class="st">&quot;9999-12-31&quot;</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="fu">}</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="ot">]</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">}</span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="ot">]</span></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<p>The history for the first employee contains two time slices that do not differ in the represented properties, caused by a department change, and the department is not part of the representation.</p>
<p>The service could have combined these two time slices into one.</p>
</div>
<div class="example">
<p>Example 15: retrieve all employees that ever worked for department D15, with their full history, and the department's data at the start of each employee history time slice</p>
<pre><code>GET /api-2/Departments(&#39;D15&#39;)/Employees?
    $expand=history(
      @emp=$this;
      $expand=Department(
        $expand=history($at=@emp/From)
      )
    )</code></pre>
<p>has the following result with department names and budgets as of the beginning of each employee time slice:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;@odata.context&quot;</span><span class="fu">:</span> <span class="st">&quot;$metadata#Employees&quot;</span><span class="fu">,</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;value&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">{</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="er">    </span> <span class="er"> </span><span class="dt">&quot;ID&quot;</span><span class="fu">:</span> <span class="st">&quot;E314&quot;</span><span class="fu">,</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;history&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="fu">{</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;McDevitt&quot;</span><span class="fu">,</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;Jobtitle&quot;</span><span class="fu">:</span> <span class="st">&quot;Junior&quot;</span><span class="fu">,</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;From&quot;</span><span class="fu">:</span> <span class="st">&quot;2011-01-01&quot;</span><span class="fu">,</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;To&quot;</span><span class="fu">:</span> <span class="st">&quot;2013-10-01&quot;</span><span class="fu">,</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;Department&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="er">           </span> <span class="dt">&quot;ID&quot;</span><span class="fu">:</span> <span class="st">&quot;D08&quot;</span><span class="fu">,</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="er">           </span> <span class="dt">&quot;history&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="fu">{</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">            </span><span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;Support&quot;</span><span class="fu">,</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">            </span><span class="dt">&quot;Budget&quot;</span><span class="fu">:</span> <span class="dv">1000</span><span class="fu">,</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="er">             </span> <span class="dt">&quot;From&quot;</span><span class="fu">:</span> <span class="st">&quot;2010-01-01&quot;</span><span class="fu">,</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="er">          </span><span class="dt">&quot;To&quot;</span><span class="fu">:</span> <span class="st">&quot;2012-10-01&quot;</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="er">           </span> <span class="fu">}</span><span class="ot">]</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="fu">}</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="fu">{</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;McDevitt&quot;</span><span class="fu">,</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;Jobtitle&quot;</span><span class="fu">:</span> <span class="st">&quot;Senior&quot;</span><span class="fu">,</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;From&quot;</span><span class="fu">:</span> <span class="st">&quot;2013-10-01&quot;</span><span class="fu">,</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;To&quot;</span><span class="fu">:</span> <span class="st">&quot;2014-01-01&quot;</span><span class="fu">,</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;Department&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a><span class="er">           </span> <span class="dt">&quot;ID&quot;</span><span class="fu">:</span> <span class="st">&quot;D08&quot;</span><span class="fu">,</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a><span class="er">           </span> <span class="dt">&quot;history&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="fu">{</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">            </span><span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;1st Level Support&quot;</span><span class="fu">,</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">            </span><span class="dt">&quot;Budget&quot;</span><span class="fu">:</span> <span class="dv">1250</span><span class="fu">,</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a><span class="er">             </span> <span class="dt">&quot;From&quot;</span><span class="fu">:</span> <span class="st">&quot;2012-06-01&quot;</span><span class="fu">,</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="er">          </span><span class="dt">&quot;To&quot;</span><span class="fu">:</span> <span class="st">&quot;2014-01-01&quot;</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a><span class="er">           </span> <span class="fu">}</span><span class="ot">]</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="fu">}</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="fu">{</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="er">  </span><span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;McDevitt&quot;</span><span class="fu">,</span></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a><span class="er">        </span> <span class="er"> </span><span class="dt">&quot;Jobtitle&quot;</span><span class="fu">:</span> <span class="st">&quot;Senior&quot;</span><span class="fu">,</span></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;From&quot;</span><span class="fu">:</span> <span class="st">&quot;2014-01-01&quot;</span><span class="fu">,</span></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;To&quot;</span><span class="fu">:</span> <span class="st">&quot;9999-12-31&quot;</span><span class="fu">,</span></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;Department&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a><span class="er">           </span> <span class="dt">&quot;ID&quot;</span><span class="fu">:</span> <span class="st">&quot;D15&quot;</span><span class="fu">,</span></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a><span class="er">           </span> <span class="dt">&quot;history&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="fu">{</span></span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">            </span><span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;Services&quot;</span><span class="fu">,</span></span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">            </span><span class="dt">&quot;Budget&quot;</span><span class="fu">:</span> <span class="dv">1170</span><span class="fu">,</span></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a><span class="er">             </span> <span class="dt">&quot;From&quot;</span><span class="fu">:</span> <span class="st">&quot;2011-01-01&quot;</span><span class="fu">,</span></span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="er">          </span><span class="dt">&quot;To&quot;</span><span class="fu">:</span> <span class="st">&quot;9999-12-31&quot;</span></span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a><span class="er">           </span> <span class="fu">}</span><span class="ot">]</span></span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="fu">}</span></span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="fu">}</span></span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="ot">]</span></span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">{</span></span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;ID&quot;</span><span class="fu">:</span> <span class="st">&quot;E401&quot;</span><span class="fu">,</span></span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;history&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="fu">{</span></span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a><span class="er">    </span> <span class="er">     </span><span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;Norman&quot;</span><span class="fu">,</span></span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;Jobtitle&quot;</span><span class="fu">:</span> <span class="st">&quot;Expert&quot;</span><span class="fu">,</span></span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">        </span><span class="dt">&quot;From&quot;</span><span class="fu">:</span> <span class="st">&quot;2009-11-01&quot;</span><span class="fu">,</span></span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a><span class="er">        </span> <span class="er"> </span><span class="dt">&quot;To&quot;</span><span class="fu">:</span> <span class="st">&quot;2012-03-01&quot;</span><span class="fu">,</span></span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;Department&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a><span class="er">           </span> <span class="dt">&quot;ID&quot;</span><span class="fu">:</span> <span class="st">&quot;D15&quot;</span><span class="fu">,</span></span>
<span id="cb19-64"><a href="#cb19-64" aria-hidden="true" tabindex="-1"></a><span class="er">           </span> <span class="dt">&quot;history&quot;</span><span class="fu">:</span> <span class="ot">[]</span></span>
<span id="cb19-65"><a href="#cb19-65" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="fu">}</span></span>
<span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="fu">{</span></span>
<span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a><span class="er">    </span> <span class="er">     </span><span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;Gibson&quot;</span><span class="fu">,</span></span>
<span id="cb19-69"><a href="#cb19-69" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;Jobtitle&quot;</span><span class="fu">:</span> <span class="st">&quot;Expert&quot;</span><span class="fu">,</span></span>
<span id="cb19-70"><a href="#cb19-70" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">        </span><span class="dt">&quot;From&quot;</span><span class="fu">:</span> <span class="st">&quot;2012-03-01&quot;</span><span class="fu">,</span></span>
<span id="cb19-71"><a href="#cb19-71" aria-hidden="true" tabindex="-1"></a><span class="er">        </span> <span class="er"> </span><span class="dt">&quot;To&quot;</span><span class="fu">:</span> <span class="st">&quot;9999-12-31&quot;</span><span class="fu">,</span></span>
<span id="cb19-72"><a href="#cb19-72" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;Department&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb19-73"><a href="#cb19-73" aria-hidden="true" tabindex="-1"></a><span class="er">           </span> <span class="dt">&quot;ID&quot;</span><span class="fu">:</span> <span class="st">&quot;D15&quot;</span><span class="fu">,</span></span>
<span id="cb19-74"><a href="#cb19-74" aria-hidden="true" tabindex="-1"></a><span class="er">           </span> <span class="dt">&quot;history&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="fu">{</span></span>
<span id="cb19-75"><a href="#cb19-75" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">            </span><span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;Services&quot;</span><span class="fu">,</span></span>
<span id="cb19-76"><a href="#cb19-76" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">            </span><span class="dt">&quot;Budget&quot;</span><span class="fu">:</span> <span class="dv">1170</span><span class="fu">,</span></span>
<span id="cb19-77"><a href="#cb19-77" aria-hidden="true" tabindex="-1"></a><span class="er">             </span> <span class="dt">&quot;From&quot;</span><span class="fu">:</span> <span class="st">&quot;2011-01-01&quot;</span><span class="fu">,</span></span>
<span id="cb19-78"><a href="#cb19-78" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="er">          </span><span class="dt">&quot;To&quot;</span><span class="fu">:</span> <span class="st">&quot;9999-12-31&quot;</span></span>
<span id="cb19-79"><a href="#cb19-79" aria-hidden="true" tabindex="-1"></a><span class="er">           </span> <span class="fu">}</span><span class="ot">]</span></span>
<span id="cb19-80"><a href="#cb19-80" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="fu">}</span></span>
<span id="cb19-81"><a href="#cb19-81" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="fu">}</span></span>
<span id="cb19-82"><a href="#cb19-82" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="ot">]</span></span>
<span id="cb19-83"><a href="#cb19-83" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">}</span></span>
<span id="cb19-84"><a href="#cb19-84" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="ot">]</span></span>
<span id="cb19-85"><a href="#cb19-85" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
</div>
<h3 id="424-interaction-with-standard-system-query-options"><a name="InteractionwithStandardSystemQueryOptions" href="#InteractionwithStandardSystemQueryOptions">4.2.4 Interaction with Standard System Query Options</a></h3>
<p>For <a href="#SnapshotEntitySet">snapshot entity sets</a> the point in time for representing data is determined following the rules in section "<a href="#PropagationofTemporalQueryOptions">Propagation of Temporal Query Options</a>" and evaluated <em>first</em>, then all other system query options are evaluated on the data valid at that point in time, including the query option <code>$apply</code> defined in <a href="#ODataAggregation">OData-Aggregation</a>.</p>
<p>For timeline entity sets the interval for filtering data is determined following the rules in section "<a href="#PropagationofTemporalQueryOptions">Propagation of Temporal Query Options</a>" and evaluated as an additional criterion for <code>$filter</code> in the evaluation sequence defined in <a href="#ODataProtocol">OData-Protocol, section System Query Options</a>, which is evaluated <em>after</em> the query option <code>$apply</code>.</p>
<div class="example">
<p>Example 16: retrieve employee history over a period of application time and filter on job title</p>
<pre><code>GET /api-2/Employees?$expand=history(
                       $select=Name,Jobtitle;
                       $from=2012-03-01&amp;$to=2025-01-01;
                       $filter=contains(Jobtitle,&#39;e&#39;)
                     )</code></pre>
<p>results in one entity for each employee with time slices that overlap the specified application-time period and satisfy the filter condition (one less than in <a href="#employeeHistory">example 14</a>):</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;@odata.context&quot;</span><span class="fu">:</span> <span class="st">&quot;$metadata#Employees&quot;</span><span class="fu">,</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;value&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">{</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="er">    </span> <span class="er"> </span><span class="dt">&quot;ID&quot;</span><span class="fu">:</span> <span class="st">&quot;E314&quot;</span><span class="fu">,</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;history&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="fu">{</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;McDevitt&quot;</span><span class="fu">,</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;Jobtitle&quot;</span><span class="fu">:</span> <span class="st">&quot;Senior&quot;</span><span class="fu">,</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;From&quot;</span><span class="fu">:</span> <span class="st">&quot;2013-10-01&quot;</span><span class="fu">,</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;To&quot;</span><span class="fu">:</span> <span class="st">&quot;2014-01-01&quot;</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="fu">{</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="er">  </span><span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;McDevitt&quot;</span><span class="fu">,</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="er">        </span> <span class="er"> </span><span class="dt">&quot;Jobtitle&quot;</span><span class="fu">:</span> <span class="st">&quot;Senior&quot;</span><span class="fu">,</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;From&quot;</span><span class="fu">:</span> <span class="st">&quot;2014-01-01&quot;</span><span class="fu">,</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;To&quot;</span><span class="fu">:</span> <span class="st">&quot;9999-12-31&quot;</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="fu">}</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="ot">]</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">{</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;ID&quot;</span><span class="fu">:</span> <span class="st">&quot;E401&quot;</span><span class="fu">,</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;history&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="fu">{</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a><span class="er">    </span> <span class="er">     </span><span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;Gibson&quot;</span><span class="fu">,</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;Jobtitle&quot;</span><span class="fu">:</span> <span class="st">&quot;Expert&quot;</span><span class="fu">,</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">        </span><span class="dt">&quot;From&quot;</span><span class="fu">:</span> <span class="st">&quot;2012-03-01&quot;</span><span class="fu">,</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="er">        </span> <span class="er"> </span><span class="dt">&quot;To&quot;</span><span class="fu">:</span> <span class="st">&quot;9999-12-31&quot;</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="fu">}</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="ot">]</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">}</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="ot">]</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
</div>
<p>The lambda operators <code>any()</code> and <code>all()</code> are not influenced by temporal query options, they are interpreted for each time slice on the filtered collection, meaning "any related time slice satisfying the lambda expression" and "all related time slices satisfy the lambda expression". The lambda expressions however can contain sub-expressions working on the period boundaries.</p>
<div class="example">
<p>Example 17: filter employees on their name at any point in time</p>
<pre><code>GET /api-2/Employees?$expand=history($select=Name,Jobtitle)
                     &amp;$from=2015-01-01
                     &amp;$filter=history/any(h:startswith(h/Name,&#39;N&#39;))</code></pre>
<p>results in one employee whose name matches in the past, and the matching time slice is not in the requested time period</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;@odata.context&quot;</span><span class="fu">:</span> <span class="st">&quot;$metadata#Employees&quot;</span><span class="fu">,</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;value&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">{</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;ID&quot;</span><span class="fu">:</span> <span class="st">&quot;E401&quot;</span><span class="fu">,</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;history&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="fu">{</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="er">    </span> <span class="er">     </span><span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;Gibson&quot;</span><span class="fu">,</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="er">         </span> <span class="dt">&quot;Jobtitle&quot;</span><span class="fu">:</span> <span class="st">&quot;Expert&quot;</span><span class="fu">,</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">        </span><span class="dt">&quot;From&quot;</span><span class="fu">:</span> <span class="st">&quot;2012-03-01&quot;</span><span class="fu">,</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="er">        </span> <span class="er"> </span><span class="dt">&quot;To&quot;</span><span class="fu">:</span> <span class="st">&quot;9999-12-31&quot;</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="fu">}</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="ot">]</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">}</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="ot">]</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
</div>
<h3 id="425-requesting-changes-to-temporal-data"><a name="RequestingChangestoTemporalData" href="#RequestingChangestoTemporalData">4.2.5 Requesting Changes to Temporal Data</a></h3>
<p>Change tracking for timeline entity sets works identical to non-temporal entity sets. If the entity set supports change-tracking combined with filtering on application-time period boundaries, the corresponding declared properties SHOULD be listed as <a href="https://github.com/oasis-tcs/odata-vocabularies/blob/master/vocabularies/Org.OData.Capabilities.V1.md#ChangeTrackingType"><code>FilterableProperties</code></a>, see <a href="#ODataVocCap">OData-VocCap</a>. Clients can then use these properties in <code>$filter</code> or use the convenience shortcuts <a href="#QueryOptionat"><code>$at</code></a> or <a href="#QueryOptionsfromtoandtoInclusive"><code>$from</code> and <code>$to</code>/<code>$toInclusive</code></a>.</p>
<p>Change tracking for snapshot entity sets only reports changes to time slices that contain the point in time specified via <a href="#QueryOptionat"><code>$at</code></a>, or the point in time at which the defining query was received if no <a href="#QueryOptionat"><code>$at</code></a> is specified. Mere passage of time does not lead to reported changes.</p>
<h2 id="43-modifying-temporal-data"><a name="ModifyingTemporalData" href="#ModifyingTemporalData">4.3 Modifying Temporal Data</a></h2>
<p>This section and its subsections describe modifications in application time, both for</p>
<ul>
<li><em>snapshot entity sets</em> with hidden application time, where time slices exist in the data persistency but are not directly visible in the entity set, each OData entity corresponds to a temporal object and only represents data at one point in time, and for</li>
<li><em>timeline entity sets</em> with visible application time, where each OData entity corresponds to an application-time slice and all application-time slices of a temporal object are part of the entity set.</li>
</ul>
<p>Modification operations fall into two categories:</p>
<ul>
<li>Direct modification of time slices, and</li>
<li>Changes to a temporal object over a period of application time that can affect multiple time slices without explicitly addressing each single affected time slice.</li>
</ul>
<h3 id="431-direct-modification-of-time-slices"><a name="DirectModificationofTimeSlices" href="#DirectModificationofTimeSlices">4.3.1 Direct Modification of Time Slices</a></h3>
<p>The temporal query options <a href="#QueryOptionat"><code>$at</code></a>, <a href="#QueryOptionsfromtoandtoInclusive"><code>$from</code> and <code>$to</code>/<code>$toInclusive</code></a> can be used with data modification operations, in which case they do not alter the modification semantics of the request, they only affect the response of the "implicit <code>GET</code>" after the data modification.</p>
<p>Modification of time slices SHOULD be done with the temporal actions defined in the next section and its subsections.</p>
<p>This specification does not define the behavior of standard insert, update, upsert, or delete requests on temporal entity sets, and potential side-effects of direct modification requests to period boundaries and adjacent time slices are beyond the scope of this specification as the underlying business logic will vary from service to service.</p>
<h3 id="432-operations-on-temporal-objects"><a name="OperationsonTemporalObjects" href="#OperationsonTemporalObjects">4.3.2 Operations on Temporal Objects</a></h3>
<p>Changes to a temporal object over a period of application time can affect multiple time slices. For timeline entity sets this can in principle be achieved by constructing batch requests with multiple operations on individual time slices. This puts burden on the client, and it also makes it harder for services to check whether the request represents a consistent change of the temporal data.</p>
<p>Both can be avoided by providing convenience operations expressing the intent of the modification and leaving the actual time slice manipulation to the service. These operations can then also be used with snapshot entity sets that do not allow direct manipulation of time slices.</p>
<p>These convenience operations are modeled as bound actions and defined in the vocabulary for temporal data <a href="#ODataVocTemporal">OData-VocTemporal</a>. Implementations SHOULD consider the preferences <code>return=representation</code> and <code>return=minimal</code> as specified inv<a href="#ODataProtocol">OData-Protocol</a>. The convenience operations are atomic (all or nothing): they either succeed and produce the result described below, or they fail and do not change the temporal objects.</p>
<p>All actions define a collection of entities as their binding parameter. This collection can be</p>
<ul>
<li>A snapshot entity set</li>
<li>A timeline entity set containing time slices for a single temporal object, or</li>
<li>A timeline entity set containing time slices for multiple temporal objects.</li>
</ul>
<p>Services MAY support any or all of these convenience actions. Services SHOULD advertise the supported actions with property <code>SupportedActions</code> of term <a href="#VocabularyforTemporalData"><code>ApplicationTimeSupport</code></a>.</p>
<p>Services may define specialized convenience operations for use cases not covered by this specification.</p>
<p>All actions return a collection of triples that consist of period start and end and a time slice, which has the same entity set as the binding parameter and advertises this through <code>odata.context</code> control information.</p>
<h4 id="4321-update-during-a-period"><a name="UpdateduringaPeriod" href="#UpdateduringaPeriod">4.3.2.1 Update during a Period</a></h4>
<p>The <code>Update</code> action updates existing time slices with values from delta time slices whose temporal object keys match and whose periods overlap.</p>
<p>Its non-binding parameter <code>deltaTimeslices</code> is a collection of a structure containing the period boundaries, the properties to update, and optionally temporal object key values. The period boundaries are interpreted according to the <a href="#VocabularyforTemporalData"><code>UnitOfTime</code></a> of the collection. In particular, <code>ClosedClosedPeriods</code> governs whether the period end of type <code>Edm.Date</code> is the last day in the period or the first day after the period. The upper period boundary for items in <code>deltaTimeslices</code> need not be supplied; if it has no declared default value, it defaults to <code>max</code>.</p>
<p>This works identical to the SQL statement UPDATE FOR PORTION OF:</p>
<ol type="1">
<li>The "delta time slices" in <code>deltaTimeslices</code> are processed in the order of the collection.</li>
<li>For each delta time slice all time slices from the bound collection are selected whose temporal object key values are identical to the values of corresponding properties present in the delta time slice, and whose application-time period overlaps with the period of the delta time slice.</li>
<li>Selected time slices whose period is not fully included in the period of the delta time slice are split into two or three consecutive time slices, one with fully included period, and one or two with a non-overlapping period immediately before or after the delta time slice's period.</li>
<li>Then all fully included time slices (including ones created in the previous step) are updated following the rules for updating entities specified in <a href="#ODataProtocol">OData-Protocol</a>.</li>
<li>Gaps between selected time slices in the period to update are not affected.</li>
</ol>
<p>On success it returns the created or updated time slices.</p>
<div class="example">
<p>Example 18: Change a department's budget during a period of application time with <a href="#api2"><code>api-2</code></a> (visible timeline)</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="er">POST</span> <span class="er">\~/Departments(&#39;D08&#39;)/history/Temporal.Update</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="er">Content-Type:</span> <span class="er">application/json</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;deltaTimeslices&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">{</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;Timeslice&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;From&quot;</span><span class="fu">:</span> <span class="st">&quot;2012-04-01&quot;</span><span class="fu">,</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;To&quot;</span><span class="fu">:</span> <span class="st">&quot;2014-07-01&quot;</span><span class="fu">,</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;Budget&quot;</span><span class="fu">:</span> <span class="dv">1320</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="fu">}</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">}</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="ot">]</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<p>Given the <a href="#ExampleData">example department data</a> the operation will split the time slice starting at 2012-01-01 creating a new time slice starting at 2012-04-01 which is then updated with the desired budget. It will then update the time slice starting at 2012-06-01 with the desired budget, and finally it will split the time slice starting at 2014-01-01 creating a new time slice starting at 2014-07-01, then update the original with the desired budget, leaving the new time slice starting at 2014-07-01 untouched:</p>
<div class="obj-1 temp-2">
<p><strong>Departments (after)</strong></p>
<table>
<thead>
<tr class="header">
<th>ID</th>
<th>From</th>
<th>To</th>
<th>Name</th>
<th>Budget</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>D08</td>
<td>2010-01-01</td>
<td>2012-01-01</td>
<td>Support</td>
<td>1000</td>
</tr>
<tr class="even">
<td>D08</td>
<td>2012-01-01</td>
<td><em>2012-04-01</em></td>
<td>Support</td>
<td>1250</td>
</tr>
<tr class="odd">
<td><em>D08</em></td>
<td><em>2012-04-01</em></td>
<td><em>2012-06-01</em></td>
<td><em>Support</em></td>
<td><em>1320</em></td>
</tr>
<tr class="even">
<td>D08</td>
<td>2012-06-01</td>
<td>2014-01-01</td>
<td>1st Level Support</td>
<td><em>1320</em></td>
</tr>
<tr class="odd">
<td>D08</td>
<td>2014-01-01</td>
<td><em>2014-07-01</em></td>
<td>1st Level Support</td>
<td><em>1320</em></td>
</tr>
<tr class="even">
<td><em>D08</em></td>
<td><em>2014-07-01</em></td>
<td><em>max</em></td>
<td><em>1st Level Support</em></td>
<td><em>1400</em></td>
</tr>
<tr class="odd">
<td>D15</td>
<td>2010-01-01</td>
<td>2011-01-01</td>
<td>Services</td>
<td>1100</td>
</tr>
<tr class="even">
<td>D15</td>
<td>2011-01-01</td>
<td>max</td>
<td>Services</td>
<td>1170</td>
</tr>
</tbody>
</table>
</div>
<p>It returns the resulting created or updated time slices</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;@odata.context&quot;</span><span class="fu">:</span> <span class="st">&quot;../../$metadata#Collection(Temporal.TimesliceWithPeriod)&quot;</span><span class="fu">,</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;value&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">{</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;Timeslice&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;@odata.context&quot;</span><span class="fu">:</span> <span class="st">&quot;#Departments(&#39;D08&#39;)/history/$entity&quot;</span><span class="fu">,</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;From&quot;</span><span class="fu">:</span> <span class="st">&quot;2012-01-01&quot;</span><span class="fu">,</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;To&quot;</span><span class="fu">:</span> <span class="st">&quot;2012-04-01&quot;</span><span class="fu">,</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;Support&quot;</span><span class="fu">,</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;Budget&quot;</span><span class="fu">:</span> <span class="dv">1250</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="fu">}</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">{</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;Timeslice&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;@odata.context&quot;</span><span class="fu">:</span> <span class="st">&quot;#Departments(&#39;D08&#39;)/history/$entity&quot;</span><span class="fu">,</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;From&quot;</span><span class="fu">:</span> <span class="st">&quot;2012-04-01&quot;</span><span class="fu">,</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;To&quot;</span><span class="fu">:</span> <span class="st">&quot;2012-06-01&quot;</span><span class="fu">,</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;Support&quot;</span><span class="fu">,</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;Budget&quot;</span><span class="fu">:</span> <span class="dv">1320</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="fu">}</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">{</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;Timeslice&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;@odata.context&quot;</span><span class="fu">:</span> <span class="st">&quot;#Departments(&#39;D08&#39;)/history/$entity&quot;</span><span class="fu">,</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">      </span><span class="dt">&quot;From&quot;</span><span class="fu">:</span> <span class="st">&quot;2012-06-01&quot;</span><span class="fu">,</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="er">    </span><span class="dt">&quot;To&quot;</span><span class="fu">:</span> <span class="st">&quot;2014-01-01&quot;</span><span class="fu">,</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;1st Level Support&quot;</span><span class="fu">,</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="er">  </span><span class="dt">&quot;Budget&quot;</span><span class="fu">:</span> <span class="dv">1320</span></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="fu">}</span></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">{</span></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="er">  </span><span class="dt">&quot;Timeslice&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;@odata.context&quot;</span><span class="fu">:</span> <span class="st">&quot;#Departments(&#39;D08&#39;)/history/$entity&quot;</span><span class="fu">,</span></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="er">  </span><span class="dt">&quot;From&quot;</span><span class="fu">:</span> <span class="st">&quot;2014-01-01&quot;</span><span class="fu">,</span></span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="er">  </span><span class="dt">&quot;To&quot;</span><span class="fu">:</span> <span class="st">&quot;2014-07-01&quot;</span><span class="fu">,</span></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;1st Level Support&quot;</span><span class="fu">,</span></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="er">  </span><span class="dt">&quot;Budget&quot;</span><span class="fu">:</span> <span class="dv">1320</span></span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="fu">}</span></span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">{</span></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;Timeslice&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;@odata.context&quot;</span><span class="fu">:</span> <span class="st">&quot;#Departments(&#39;D08&#39;)/history/$entity&quot;</span><span class="fu">,</span></span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;From&quot;</span><span class="fu">:</span> <span class="st">&quot;2014-07-01&quot;</span><span class="fu">,</span></span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;To&quot;</span><span class="fu">:</span> <span class="st">&quot;9999-12-31&quot;</span><span class="fu">,</span></span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;1st Level Support&quot;</span><span class="fu">,</span></span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;Budget&quot;</span><span class="fu">:</span> <span class="dv">1400</span></span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="fu">}</span></span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">}</span></span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="ot">]</span></span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<p>The service could have joined the third and fourth time slice because they do not significantly differ.</p>
</div>
<div class="example">
<p>Example 19: Change an employee's job title during a period of application time with <a href="#api1"><code>api-1</code></a> (snapshot). Note that the period boundaries are not visible in <a href="#api1"><code>api-1</code></a> and are provided as <code>PeriodStart</code> and <code>PeriodEnd</code> next to the <code>Timeslice</code> data. The <code>PeriodEnd</code> is omitted, meaning the end of application time.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="er">POST</span> <span class="er">\~/Employees/Temporal.Update</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="er">Content-Type:</span> <span class="er">application/json</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="er"> </span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;deltaTimeslices&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">{</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;PeriodStart&quot;</span><span class="fu">:</span> <span class="st">&quot;2021-10-01&quot;</span><span class="fu">,</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;Timeslice&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">      </span><span class="dt">&quot;ID&quot;</span><span class="fu">:</span> <span class="st">&quot;E401&quot;</span><span class="fu">,</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;Jobtitle&quot;</span><span class="fu">:</span> <span class="st">&quot;Ultimate Expert&quot;</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="fu">}</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">}</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="ot">]</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<p>Given the <a href="#ExampleData">example employee data</a> the operation will split the time slice for employee <code>E401</code> starting at 2012-03-01 creating a new time slice starting at 2021-10-01 which is then updated with the desired job title.</p>
<div class="obj-1 temp-2 nav-6">
<!-- TODO: color changed cells -->

<p><strong>Employees (after)</strong></p>
<table>
<thead>
<tr class="header">
<th>ID</th>
<th>From</th>
<th>To</th>
<th>Name</th>
<th>Jobtitle</th>
<th>Department.ID</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>E314</td>
<td>2011-01-01</td>
<td>2013-10-01</td>
<td>McDevitt</td>
<td>Junior</td>
<td>D08</td>
</tr>
<tr class="even">
<td>E314</td>
<td>2013-10-01</td>
<td>2014-01-01</td>
<td>McDevitt</td>
<td>Senior</td>
<td>D08</td>
</tr>
<tr class="odd">
<td>E314</td>
<td>2014-01-01</td>
<td>max</td>
<td>McDevitt</td>
<td>Senior</td>
<td>D15</td>
</tr>
<tr class="even">
<td>E401</td>
<td>2009-11-01</td>
<td>2012-03-01</td>
<td>Norman</td>
<td>Expert</td>
<td>D15</td>
</tr>
<tr class="odd">
<td>E401</td>
<td>2012-03-01</td>
<td><em>2021-10-01</em></td>
<td>Gibson</td>
<td>Expert</td>
<td>D15</td>
</tr>
<tr class="even">
<td><em>E401</em></td>
<td><em>2021-10-01</em></td>
<td><em>max</em></td>
<td><em>Gibson</em></td>
<td><em>Ultimate Expert</em></td>
<td><em>D15</em></td>
</tr>
</tbody>
</table>
</div>
<p>It returns the resulting created or updated time slices</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;@odata.context&quot;</span><span class="fu">:</span> <span class="st">&quot;../$metadata#Collection(Temporal.TimesliceWithPeriod)&quot;</span><span class="fu">,</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;value&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">{</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;PeriodStart&quot;</span><span class="fu">:</span> <span class="st">&quot;2012-03-01&quot;</span><span class="fu">,</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;PeriodEnd&quot;</span><span class="fu">:</span> <span class="st">&quot;2021-10-01&quot;</span><span class="fu">,</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;Timeslice&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;@odata.context&quot;</span><span class="fu">:</span> <span class="st">&quot;#Employees/$entity&quot;</span><span class="fu">,</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">      </span><span class="dt">&quot;ID&quot;</span><span class="fu">:</span> <span class="st">&quot;E401&quot;</span><span class="fu">,</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;Gibson&quot;</span><span class="fu">,</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="er">    </span><span class="dt">&quot;Jobtitle&quot;</span><span class="fu">:</span> <span class="st">&quot;Expert&quot;</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="fu">}</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">{</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;PeriodStart&quot;</span><span class="fu">:</span> <span class="st">&quot;2021-10-01&quot;</span><span class="fu">,</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;PeriodEnd&quot;</span><span class="fu">:</span> <span class="st">&quot;9999-12-31&quot;</span><span class="fu">,</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;Timeslice&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;@odata.context&quot;</span><span class="fu">:</span> <span class="st">&quot;#Employees/$entity&quot;</span><span class="fu">,</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">      </span><span class="dt">&quot;ID&quot;</span><span class="fu">:</span> <span class="st">&quot;E401&quot;</span><span class="fu">,</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;Name&quot;</span><span class="fu">:</span> <span class="st">&quot;Gibson&quot;</span><span class="fu">,</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">      </span><span class="dt">&quot;Jobtitle&quot;</span><span class="fu">:</span> <span class="st">&quot;Ultimate Expert&quot;</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="fu">}</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">}</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="ot">]</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
</div>
<h4 id="4322-upsert-during-a-period"><a name="UpsertduringaPeriod" href="#UpsertduringaPeriod">4.3.2.2 Upsert during a Period</a></h4>
<p>The <code>Upsert</code> action upserts existing time slices with values from delta time slices whose temporal object keys match and whose periods overlap, and in addition creates new time slices to close gaps in the matching time period.</p>
<p>It has the same signature as <a href="#UpdateduringaPeriod"><code>Update</code></a>, and steps 1 to 4 work identical to <a href="#UpdateduringaPeriod"><code>Update</code></a>. Step 5 is</p>
<ol start="5" type="1">
<li><p>Gaps between selected time slices in the period to update are closed by creating new adjacent time slices: for each gap that has an immediately preceding time slice, a new time slice is created by</p>
<ol type="1">
<li>copying the property values of the preceding time slice (except for computed properties),</li>
<li>setting the period boundaries to close the gap, and then</li>
<li>updating the new time slice following the rules for updating entities specified in <a href="#ODataProtocol">OData-Protocol</a>.</li>
</ol>
<p>If no preceding time slice exists, the time slice is created following the rules for creating entities specified in <a href="#ODataProtocol">OData-Protocol</a>.</p></li>
</ol>
<p>On success it returns the created or updated time slices.</p>
<div class="example">
<p>Example 20: Upsert two <a href="#CostCenters">cost centers</a> during a period of application time using the model from Example 8</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="er">POST</span> <span class="er">\~/CostCenters/Temporal.Upsert</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="er">Content-Type:</span> <span class="er">application/json</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;deltaTimeslices&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">{</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;Timeslice&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;AreaID&quot;</span><span class="fu">:</span> <span class="st">&quot;51&quot;</span><span class="fu">,</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;CostCenterID&quot;</span><span class="fu">:</span> <span class="st">&quot;C1&quot;</span><span class="fu">,</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;ValidTo&quot;</span><span class="fu">:</span> <span class="st">&quot;2001-03-31&quot;</span><span class="fu">,</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;ValidFrom&quot;</span><span class="fu">:</span> <span class="st">&quot;1984-04-01&quot;</span><span class="fu">,</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;ProfitCenterID&quot;</span><span class="fu">:</span> <span class="st">&quot;P2&quot;</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="fu">}</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">{</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;Timeslice&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;AreaID&quot;</span><span class="fu">:</span> <span class="st">&quot;51&quot;</span><span class="fu">,</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;CostCenterID&quot;</span><span class="fu">:</span> <span class="st">&quot;C2&quot;</span><span class="fu">,</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;ValidFrom&quot;</span><span class="fu">:</span> <span class="st">&quot;2012-04-01&quot;</span><span class="fu">,</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;DepartmentID&quot;</span><span class="fu">:</span> <span class="st">&quot;D04&quot;</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="fu">}</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">}</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="ot">]</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<p>Given this example data (primary key in olive)</p>
<div class="key-1 obj-2 obj-3 temp-4">
<p><strong>CostCenters (before)</strong></p>
<table>
<thead>
<tr class="header">
<th>tsid</th>
<th>AreaID</th>
<th>CostCenterID</th>
<th>ValidTo</th>
<th>ValidFrom</th>
<th>ProfitCenterID</th>
<th>DepartmentID</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>n</td>
<td>51</td>
<td>C1</td>
<td>max</td>
<td>1955-04-01</td>
<td>P1</td>
<td>D02</td>
</tr>
</tbody>
</table>
</div>
<p>the operation will split the time slice <code>n</code> for cost center <code>C1</code> starting at 1955-04-01 creating two new time slices, the one starting at 1984-04-01 is then updated with the desired profit center. It will also insert a new time slice for the not yet existing cost center <code>C2</code> with the desired values.</p>
<p>Note that this example uses closed-closed periods, so each time slice ends the day before the start of the next adjacent time slice.</p>
<!-- TODO: color changed cells -->

<div class="key-1 obj-2 obj-3 temp-4">
<p><strong>CostCenters (after)</strong></p>
<table>
<thead>
<tr class="header">
<th>tsid</th>
<th>AreaID</th>
<th>CostCenterID</th>
<th>ValidTo</th>
<th>ValidFrom</th>
<th>ProfitCenterID</th>
<th>DepartmentID</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>n</td>
<td>51</td>
<td>C1</td>
<td><em>1984-03-31</em></td>
<td>1955-04-01</td>
<td>P1</td>
<td>D02</td>
</tr>
<tr class="even">
<td><em>o</em></td>
<td><em>51</em></td>
<td><em>C1</em></td>
<td><em>2001-03-31</em></td>
<td><em>1984-04-01</em></td>
<td><em>P2</em></td>
<td><em>D02</em></td>
</tr>
<tr class="odd">
<td><em>p</em></td>
<td><em>51</em></td>
<td><em>C1</em></td>
<td><em>max</em></td>
<td><em>2001-04-01</em></td>
<td><em>P1</em></td>
<td><em>D02</em></td>
</tr>
<tr class="even">
<td><em>q</em></td>
<td><em>51</em></td>
<td><em>C2</em></td>
<td><em>max</em></td>
<td><em>2012-04-01</em></td>
<td> </td>
<td><em>D04</em></td>
</tr>
</tbody>
</table>
</div>
<p>It returns the resulting created or updated time slices per affected temporal object</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;@odata.context&quot;</span><span class="fu">:</span> <span class="st">&quot;../$metadata#Collection(Temporal.TimesliceWithPeriod)&quot;</span><span class="fu">,</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="dt">&quot;value&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">{</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;Timeslice&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;@odata.context&quot;</span><span class="fu">:</span> <span class="st">&quot;#CostCenters/$entity&quot;</span><span class="fu">,</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">      </span><span class="dt">&quot;tsid&quot;</span><span class="fu">:</span> <span class="st">&quot;n&quot;</span><span class="fu">,</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">      </span><span class="dt">&quot;AreaID&quot;</span><span class="fu">:</span> <span class="st">&quot;51&quot;</span><span class="fu">,</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="er">    </span><span class="dt">&quot;CostCenterID&quot;</span><span class="fu">:</span> <span class="st">&quot;C1&quot;</span><span class="fu">,</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="er">  </span><span class="dt">&quot;ValidTo&quot;</span><span class="fu">:</span> <span class="st">&quot;1984-03-31&quot;</span><span class="fu">,</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">      </span><span class="dt">&quot;ValidFrom&quot;</span><span class="fu">:</span> <span class="st">&quot;1955-04-01&quot;</span><span class="fu">,</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="er">    </span><span class="dt">&quot;ProfitCenterID&quot;</span><span class="fu">:</span> <span class="st">&quot;P1&quot;</span><span class="fu">,</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="er">  </span><span class="dt">&quot;DepartmentID&quot;</span><span class="fu">:</span> <span class="st">&quot;D02&quot;</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="fu">}</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">{</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;Timeslice&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;@odata.context&quot;</span><span class="fu">:</span> <span class="st">&quot;#CostCenters/$entity&quot;</span><span class="fu">,</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">      </span><span class="dt">&quot;tsid&quot;</span><span class="fu">:</span> <span class="st">&quot;o&quot;</span><span class="fu">,</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">      </span><span class="dt">&quot;AreaID&quot;</span><span class="fu">:</span> <span class="st">&quot;51&quot;</span><span class="fu">,</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="er">    </span><span class="dt">&quot;CostCenterID&quot;</span><span class="fu">:</span> <span class="st">&quot;C1&quot;</span><span class="fu">,</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="er">  </span><span class="dt">&quot;ValidTo&quot;</span><span class="fu">:</span> <span class="st">&quot;2001-03-31&quot;</span><span class="fu">,</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">      </span><span class="dt">&quot;ValidFrom&quot;</span><span class="fu">:</span> <span class="st">&quot;1984-04-01&quot;</span><span class="fu">,</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="er">    </span><span class="dt">&quot;ProfitCenterID&quot;</span><span class="fu">:</span> <span class="st">&quot;P2&quot;</span><span class="fu">,</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="er">  </span><span class="dt">&quot;DepartmentID&quot;</span><span class="fu">:</span> <span class="st">&quot;D02&quot;</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="fu">}</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">{</span></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;Timeslice&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;@odata.context&quot;</span><span class="fu">:</span> <span class="st">&quot;#CostCenters/$entity&quot;</span><span class="fu">,</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">      </span><span class="dt">&quot;tsid&quot;</span><span class="fu">:</span> <span class="st">&quot;p&quot;</span><span class="fu">,</span></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">      </span><span class="dt">&quot;AreaID&quot;</span><span class="fu">:</span> <span class="st">&quot;51&quot;</span><span class="fu">,</span></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="er">    </span><span class="dt">&quot;CostCenterID&quot;</span><span class="fu">:</span> <span class="st">&quot;C1&quot;</span><span class="fu">,</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="er">  </span><span class="dt">&quot;ValidTo&quot;</span><span class="fu">:</span> <span class="st">&quot;9999-12-31&quot;</span><span class="fu">,</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">      </span><span class="dt">&quot;ValidFrom&quot;</span><span class="fu">:</span> <span class="st">&quot;2001-04-01&quot;</span><span class="fu">,</span></span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">      </span><span class="dt">&quot;ProfitCenterID&quot;</span><span class="fu">:</span> <span class="st">&quot;P1&quot;</span><span class="fu">,</span></span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">      </span><span class="dt">&quot;DepartmentID&quot;</span><span class="fu">:</span> <span class="st">&quot;D02&quot;</span></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="fu">}</span></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">{</span></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="dt">&quot;Timeslice&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a><span class="er">       </span> <span class="dt">&quot;@odata.context&quot;</span><span class="fu">:</span> <span class="st">&quot;#CostCenters/$entity&quot;</span><span class="fu">,</span></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">      </span><span class="dt">&quot;tsid&quot;</span><span class="fu">:</span> <span class="st">&quot;q&quot;</span><span class="fu">,</span></span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">      </span><span class="dt">&quot;AreaID&quot;</span><span class="fu">:</span> <span class="st">&quot;51&quot;</span><span class="fu">,</span></span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="er">    </span><span class="dt">&quot;CostCenterID&quot;</span><span class="fu">:</span> <span class="st">&quot;C2&quot;</span><span class="fu">,</span></span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="er">  </span><span class="dt">&quot;ValidTo&quot;</span><span class="fu">:</span> <span class="st">&quot;9999-12-31&quot;</span><span class="fu">,</span></span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">      </span><span class="dt">&quot;ValidFrom&quot;</span><span class="fu">:</span> <span class="st">&quot;2012-04-01&quot;</span><span class="fu">,</span></span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">      </span><span class="dt">&quot;ProfitCenterID&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="er">      </span><span class="dt">&quot;DepartmentID&quot;</span><span class="fu">:</span> <span class="st">&quot;D04&quot;</span></span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a><span class="er">     </span> <span class="fu">}</span></span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a><span class="er">   </span> <span class="fu">}</span></span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a><span class="er"> </span> <span class="ot">]</span></span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
</div>
<h4 id="4323-delete-during-a-period"><a name="DeleteduringaPeriod" href="#DeleteduringaPeriod">4.3.2.3 Delete during a Period</a></h4>
<p>The <code>Delete</code> action deletes (sub-periods of) time slices.</p>
<p>Its non-binding parameter <code>deltaTimeslices</code> is a collection of a structure containing the period boundaries and optionally temporal object key values. The period boundaries are interpreted according to the <a href="#VocabularyforTemporalData"><code>UnitOfTime</code></a> of the collection. In particular, <code>ClosedClosedPeriods</code> governs whether the period end of type <code>Edm.Date</code> is the last day in the period or the first day after the period.</p>
<p>This works identical to the SQL statement DELETE FOR PORTION OF:</p>
<ol type="1">
<li>The "delta time slices" in <code>deltaTimeslices</code> are processed in the order of the collection.</li>
<li>For each delta time slice all time slices from the bound collection are selected whose temporal object key values are identical to the values of corresponding properties present in the delta time slice, and whose application-time period overlaps with the period of the delta time slice.</li>
<li>Selected time slices whose period is not fully included in the period of the delta time slice are split into two consecutive time slices, one with non-overlapping, and one with fully included period.</li>
<li>Then all fully included time slices (including ones created in the previous step) are deleted following the rules for deleting entities specified in <a href="#ODataProtocol">OData-Protocol</a>.</li>
</ol>
<p>On success it returns the deleted time slices.</p>
<h3 id="433-etags"><a name="ETags" href="#ETags">4.3.3 ETags</a></h3>
<p>Timeline entity sets need no special consideration as each time slice is an OData entity.</p>
<p>This specification does not define the behavior of standard insert, update, upsert, or delete requests for snapshot entity sets and consequently defines no rules for ETags of entities in snapshot entity sets. Services supporting these requests are advised to associate ETags with time slices rather than with temporal objects.</p>
<h3 id="434-read-edit-navigation-and-association-urls"><a name="ReadEditNavigationandAssociationURLs" href="#ReadEditNavigationandAssociationURLs">4.3.4 Read, Edit, Navigation, and Association URLs</a></h3>
<p>Timeline entity sets need no special consideration as each time slice is an OData entity.</p>
<p>For snapshot entity sets read, edit, navigation, and association URLs are not specific to time slices, they are specific to the time-independent OData entity.</p>
<hr />
<h1 id="5-conformance"><a name="Conformance" href="#Conformance">5 Conformance</a></h1>
<p>Conforming services MUST follow all rules of this specification for the temporal system query options they support.</p>
<p>Conforming clients MUST be prepared to consume a model that uses any or all constructs defined in this specification.</p>
<hr />
<h1 id="appendix-a-references"><a name="References" href="#References">Appendix A. References</a></h1>
<p>This appendix contains the normative and informative references that are used in this document.</p>
<p>While any hyperlinks included in this appendix were valid at the time of publication, OASIS cannot guarantee their long-term validity.</p>
<h2 id="a1-normative-references"><a name="NormativeReferences" href="#NormativeReferences">A.1 Normative References</a></h2>
<p>The following documents are referenced in such a way that some or all of their content constitutes requirements of this document.</p>
<h6 id="odata-abnf"><a name="ODataABNF">[OData-ABNF]</a></h6>
<p><em>ABNF components: OData ABNF Construction Rules Version 4.02 and OData ABNF Test Cases.</em><br />
See link in "<a href="#RelatedWork">Related work</a>" section on cover page.</p>
<h6 id="odata-aggregation"><a name="ODataAggregation">[OData-Aggregation]</a></h6>
<p><em>OData Extension for Data Aggregation Version 4.0.</em><br />
See link in "<a href="#RelatedWork">Related work</a>" section on cover page.</p>
<h6 id="odata-csdl"><a name="ODataCSDL">[OData-CSDL]</a></h6>
<p><em>OData Common Schema Definition Language (CSDL) JSON Representation Version 4.02.</em><br />
See link in "<a href="#RelatedWork">Related work</a>" section on cover page.</p>
<p><em>OData Common Schema Definition Language (CSDL) XML Representation Version 4.02.</em><br />
See link in "<a href="#RelatedWork">Related work</a>" section on cover page.</p>
<h6 id="odata-protocol"><a name="ODataProtocol">[OData-Protocol]</a></h6>
<p><em>OData Version 4.02. Part 1: Protocol.</em><br />
See link in "<a href="#RelatedWork">Related work</a>" section on cover page.</p>
<h6 id="odata-url"><a name="ODataURL">[OData-URL]</a></h6>
<p><em>OData Version 4.02. Part 2: URL Conventions.</em><br />
See link in "<a href="#RelatedWork">Related work</a>" section on cover page.</p>
<h6 id="odata-voccap"><a name="ODataVocCap">[OData-VocCap]</a></h6>
<p><em>OData Vocabularies Version 4.0: Capabilities Vocabulary.</em><br />
See link in "<a href="#RelatedWork">Related work</a>" section on cover page.</p>
<h6 id="odata-voccore"><a name="ODataVocCore">[OData-VocCore]</a></h6>
<p><em>OData Vocabularies Version 4.0: Core Vocabulary.</em><br />
See link in "<a href="#RelatedWork">Related work</a>" section on cover page.</p>
<h6 id="odata-voctemporal"><a name="ODataVocTemporal">[OData-VocTemporal]</a></h6>
<p><em>OData Temporal Vocabulary.</em><br />
See link in "<a href="#AdditionalArtifacts">Additional artifacts</a>" section on cover page.</p>
<h6 id="rfc2119"><a name="rfc2119">[RFC2119]</a></h6>
<p><em>Bradner, S., "Key words for use in RFCs to Indicate Requirement Levels", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997</em><br />
<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>.</p>
<h6 id="rfc8174"><a name="rfc8174">[RFC8174]</a></h6>
<p><em>Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174, May 2017</em><br />
<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>.</p>
<h2 id="a2-informative-references"><a name="InformativeReferences" href="#InformativeReferences">A.2 Informative References</a></h2>
<h6 id="fowler"><a name="Fowler">[Fowler]</a></h6>
<p><em>Martin Fowler, "Temporal Patterns", 16 February 2005</em><br />
<a href="http://martinfowler.com/eaaDev/timeNarrative.html">http://martinfowler.com/eaaDev/timeNarrative.html</a>.</p>
<h6 id="kulkarni"><a name="Kulkarni">[Kulkarni]</a></h6>
<p><em>Krishna Kulkarni, "Temporal Features in SQL standard", September 2012</em><br />
<a href="https://dbs.uni-leipzig.de/file/Temporal%20features%20in%20SQL2011.pdf">https://dbs.uni-leipzig.de/file/Temporal%20features%20in%20SQL2011.pdf</a>.</p>
<h6 id="fowsnodgrassler"><a name="Snodgrass">[FowSnodgrassler]</a></h6>
<p><em>Richard T. Snodgrass, "Developing Time-Oriented Database Applications in SQL", Morgan Kaufmann Publishers, Inc., San Francisco, July, 1999, ISBN 1-55860-436-7</em><br />
<a href="http://www2.cs.arizona.edu/people/rts/tdbbook.pdf">http://www2.cs.arizona.edu/people/rts/tdbbook.pdf</a> and <a href="http://www2.cs.arizona.edu/people/rts/pp30-31.pdf">http://www2.cs.arizona.edu/people/rts/pp30-31.pdf</a>.</p>
<h6 id="sql2011"><a name="SQL">[SQL:2011]</a></h6>
<p><em>ISO/IEC 9075-2:2011 Information technology - Database languages - SQL - Part 2: Foundation (SQL/Foundation)</em>.</p>
<hr />
<h1 id="appendix-b-acknowledgments"><a name="Acknowledgments" href="#Acknowledgments">Appendix B. Acknowledgments</a></h1>
<h2 id="b1-special-thanks"><a name="SpecialThanks" href="#SpecialThanks">B.1 Special Thanks</a></h2>
<p>The contributions of the OASIS OData Technical Committee members, enumerated in <a href="#ODataProtocol">OData-Protocol</a> are gratefully acknowledged.</p>
<p>Special thanks to Andrew Eisenberg, whose contributions in the early stages of the OData TC were invaluable to getting this extension specification on track.</p>
<h2 id="b2-participants"><a name="Participants" href="#Participants">B.2 Participants</a></h2>
<p><strong>OData TC Members:</strong></p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">First Name</th>
<th style="text-align: left;">Last Name</th>
<th style="text-align: left;">Company</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">George</td>
<td style="text-align: left;">Ericson</td>
<td style="text-align: left;">Dell</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hubert</td>
<td style="text-align: left;">Heijkers</td>
<td style="text-align: left;">IBM</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ling</td>
<td style="text-align: left;">Jin</td>
<td style="text-align: left;">IBM</td>
</tr>
<tr class="even">
<td style="text-align: left;">Stefan</td>
<td style="text-align: left;">Hagen</td>
<td style="text-align: left;">Individual</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Michael</td>
<td style="text-align: left;">Pizzo</td>
<td style="text-align: left;">Microsoft</td>
</tr>
<tr class="even">
<td style="text-align: left;">Christof</td>
<td style="text-align: left;">Sprenger</td>
<td style="text-align: left;">Microsoft</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ralf</td>
<td style="text-align: left;">Handl</td>
<td style="text-align: left;">SAP SE</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gerald</td>
<td style="text-align: left;">Krause</td>
<td style="text-align: left;">SAP SE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Heiko</td>
<td style="text-align: left;">Theißen</td>
<td style="text-align: left;">SAP SE</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mark</td>
<td style="text-align: left;">Biamonte</td>
<td style="text-align: left;">Progress Software</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Martin</td>
<td style="text-align: left;">Zurmuehl</td>
<td style="text-align: left;">SAP SE</td>
</tr>
</tbody>
</table>
<hr />
<h1 id="appendix-c-revision-history"><a name="RevisionHistory" href="#RevisionHistory">Appendix C. Revision History</a></h1>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Revision</th>
<th style="text-align: left;">Date</th>
<th style="text-align: left;">Editor</th>
<th style="text-align: left;">Changes Made</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Working Draft 01</td>
<td style="text-align: left;">2013-09-05</td>
<td style="text-align: left;">Ralf Handl</td>
<td style="text-align: left;">Initial working draft</td>
</tr>
<tr class="even">
<td style="text-align: left;">Committee Specification Draft 01</td>
<td style="text-align: left;">2021-07-22</td>
<td style="text-align: left;">Ralf Handl<br>Hubert Heijkers<br> Gerald Krause<br> Michael Pizzo<br> Heiko Theißen<br> Martin Zurmuehl</td>
<td style="text-align: left;">Timeline entity sets for manipulating time slices<br> Snapshot entity sets for hiding application-time dependency<br> Modification during a period via actions<br> Closed-closed application time</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Committee Specification Draft 02</td>
<td style="text-align: left;">2021-10-15</td>
<td style="text-align: left;">Ralf Handl</td>
<td style="text-align: left;">Example model with object key<br> Example for Update action on snapshot entity set<br> Example for Upsert action with object key<br> Semantics of omitting upper period boundaries in action parameters</td>
</tr>
<tr class="even">
<td style="text-align: left;">Committee Specification Draft 03</td>
<td style="text-align: left;">2021-12-02</td>
<td style="text-align: left;">Ralf Handl</td>
<td style="text-align: left;">Removed the “stop on change” actions<br> Minor clarifications</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Committee Specification 01</td>
<td style="text-align: left;">2022-01-07</td>
<td style="text-align: left;">Ralf Handl</td>
<td style="text-align: left;">Non-material changes</td>
</tr>
</tbody>
</table>
<hr />
<h1 id="appendix-d-notices"><a name="Notices" href="#Notices">Appendix D. Notices</a></h1>
<!-- Required section. Do not modify. -->

<p>Copyright © OASIS Open 2023. All Rights Reserved.</p>
<p>All capitalized terms in the following text have the meanings assigned to them in the OASIS Intellectual Property Rights Policy (the "OASIS IPR Policy"). The full <a href="https://www.oasis-open.org/policies-guidelines/ipr/">Policy</a> may be found at the OASIS website.</p>
<p>This document and translations of it may be copied and furnished to others, and derivative works that comment on or otherwise explain it or assist in its implementation may be prepared, copied, published, and distributed, in whole or in part, without restriction of any kind, provided that the above copyright notice and this section are included on all such copies and derivative works. However, this document itself may not be modified in any way, including by removing the copyright notice or references to OASIS, except as needed for the purpose of developing any document or deliverable produced by an OASIS Technical Committee (in which case the rules applicable to copyrights, as set forth in the OASIS IPR Policy, must be followed) or as required to translate it into languages other than English.</p>
<p>The limited permissions granted above are perpetual and will not be revoked by OASIS or its successors or assigns.</p>
<p>This document and the information contained herein is provided on an "AS IS" basis and OASIS DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY OWNERSHIP RIGHTS OR ANY IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.</p>
<p>As stated in the OASIS IPR Policy, the following three paragraphs in brackets apply to OASIS Standards Final Deliverable documents (Committee Specification, Candidate OASIS Standard, OASIS Standard, or Approved Errata).</p>
<p>[OASIS requests that any OASIS Party or any other party that believes it has patent claims that would necessarily be infringed by implementations of this OASIS Standards Final Deliverable, to notify OASIS TC Administrator and provide an indication of its willingness to grant patent licenses to such patent claims in a manner consistent with the IPR Mode of the OASIS Technical Committee that produced this deliverable.]</p>
<p>[OASIS invites any party to contact the OASIS TC Administrator if it is aware of a claim of ownership of any patent claims that would necessarily be infringed by implementations of this OASIS Standards Final Deliverable by a patent holder that is not willing to provide a license to such patent claims in a manner consistent with the IPR Mode of the OASIS Technical Committee that produced this OASIS Standards Final Deliverable. OASIS may include such claims on its website, but disclaims any obligation to do so.]</p>
<p>[OASIS takes no position regarding the validity or scope of any intellectual property or other rights that might be claimed to pertain to the implementation or use of the technology described in this OASIS Standards Final Deliverable or the extent to which any license under such rights might or might not be available; neither does it represent that it has made any effort to identify any such rights. Information on OASIS' procedures with respect to rights in any document or deliverable produced by an OASIS Technical Committee can be found on the OASIS website. Copies of claims of rights made available for publication and any assurances of licenses to be made available, or the result of an attempt made to obtain a general license or permission for the use of such proprietary rights by implementers or users of this OASIS Standards Final Deliverable, can be obtained from the OASIS TC Administrator. OASIS makes no representation that any information or list of intellectual property rights will at any time be complete, or that any claims in such list are, in fact, Essential Claims.]</p>
<p>The name "OASIS" is a trademark of <a href="https://www.oasis-open.org/">OASIS</a>, the owner and developer of this specification, and should be used only to refer to the organization and its official outputs. OASIS welcomes reference to, and implementation and use of, specifications, while reserving the right to enforce its marks against misleading uses. Please see <a href="https://www.oasis-open.org/policies-guidelines/trademark/">https://www.oasis-open.org/policies-guidelines/trademark/</a> for above guidance.</p>
</body>
</html>
